{"version":3,"sources":["utils/index.js","components/NodeName.js","components/SearchBar/NodeRow.js","components/SearchBar/component.js","components/SearchBar/connected.js","components/MapView/NodeMarker.js","components/MapView/KioskMarker.js","components/MapView/LinkLine.js","components/MapView/Sector.js","components/NodeDetail/component.js","components/NodeDetail/connected.js","components/MapView/component.js","components/MapView/styles.js","components/MapView/connected.js","actions/index.js","components/Filters/component.js","components/Filters/connected.js","components/Gallery/component.js","components/Gallery/connected.js","reducers/index.js","App.js","index.js"],"names":["nodeNames","227","570","713","nodeName","node","id","concat","nodeStatus","status","notes","panoramas","isActive","isSupernode","toLowerCase","indexOf","isHub","hasPanoramas","length","nodeColors","active","dead","hub","kiosk","linkNYC","potential-hub","potential-supernode","potential","supernode","icons","react_default","a","createElement","xmlns","width","height","cx","cy","r","stroke","strokeWidth","fill","opacity","NodeName","_this$props","this","props","search","className","main_default","highlightClassName","searchWords","autoEscape","textToHighlight","String","PureComponent","NodeRow","onClick","Link","to","key","NodeName_NodeName","SearchBar","state","filteredNodes","showDropdown","prevProps","prevState","nodes","setState","filterSearch","renderSearchBar","renderList","_this2","refs","focus","viewBox","strokeLinecap","strokeLinejoin","style","minWidth","x1","y1","x2","y2","ref","value","placeholder","spellCheck","autoCorrect","onFocus","onChange","event","target","renderClearButton","_this3","map","NodeRow_NodeRow","iconColor","colorForNode","_this4","Object","toConsumableArray","filter","parseInt","name","location","email","join","sort","b","tickets","connect","ownProps","dispatch","PureSearchBar","NodeMarker","history","context","router","_node$coordinates","slicedToArray","coordinates","lng","lat","_this$getMarkerProps","getMarkerProps","icon","zIndex","lib","defaultPosition","options","getOpacity","getZIndex","push","visibility","defaultZIndex","url","anchor","x","y","contextTypes","PropTypes","object","RouterNodeMarker","withRouter","CombinedMarker","assign","KioskMarker","_kiosk$coordinates","LinkLine","link","_link$coordinates","start","end","_start","lng1","lat1","_end","lng2","latlng1","latlng2","_this$getLineProps","getLineProps","strokeColor","strokeOpacity","path","defaultOpacity","azimuth","centerPoint","PRlat","Math","PI","PRlng","cos","PGpoints","lon1","sin","lat2","lon2","theta","gamma","PGlon","PGlat","defaultOptions","fillColor","fillOpacity","clickable","NodeDetail","match","matchingNodes","params","nodeId","_coordinates","InfoBox_default","position","window","google","maps","LatLng","boxStyle","overflow","boxClass","alignBottom","closeBoxURL","enableEventPropagation","marginLeft","marginRight","renderImage","version","aria-hidden","fillRule","d","firstPanorama","backgroundImage","styles","elementType","stylers","featureType","fullscreenControl","streetViewControl","zoomControlOptions","mapTypeControlOptions","backgroundColor","gestureHandling","clickableIcons","MapComponent","withScriptjs","withGoogleMap","mapRef","children","MapView","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","React","createRef","markerRefs","lineRefs","setTimeout","selectedNodeId","selectedMarker","selectedNode","updateNodes","updateLinks","panToNode","e","console","error","nextProps","handleSelectedChange","resetAllNodes","nextSelectedNodeId","nextSelectedMarker","nextSelectedNode","defaultZoom","defaultCenter","googleMapURL","loadingElement","containerElement","mapElement","renderSectors","renderLinks","renderKiosks","renderNodes","NodeDetail_connected","selectNode","NodeMarker_CombinedMarker","handleMarkerRef","kiosks","KioskMarker_KioskMarker","links","index","LinkLine_LinkLine","linkId","handleLineRef","react","Sector_LinkLine","_this5","ReactDOM","unstable_batchedUpdates","values","forEach","marker","setVisibility","line","_this6","connectedNodes","keys","connectedNodeId","connectedMarker","_this7","current","panTo","from","toString","Component","filteredLinks","type","PureMapView","labels","Filters","role","label","renderFilter","filters","statusCounts","toggleFilter","undefined","defaultChecked","htmlFor","color","marginTop","marginBottom","replace","PureFilters","Gallery","keyDownHandler","handleKeyDown","bind","addEventListener","removeEventListener","keyCode","_match$params","panoId","src","react_document_title_default","title","onKeyDown","onKeyPressed","open","alt","log","PureGallery","defineProperty","reverse","arguments","keyA","parse","keyB","nodeMap","fromNode","toNode","initialFilters","initialState","filterNodes","filterLinks","reducer","action","newFilters","objectSpread","store","createStore","rootReducer","App","es","BrowserRouter","basename","connected","Route","_ref","MapView_connected","Filters_connected","component","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.3674eebf.chunk.js","sourcesContent":["// Temporary hack\nconst nodeNames = {\n\t227: \"Supernode 1\",\n\t570: \"Supernode 2\",\n\t713: \"Supernode 3\"\n};\n\nexport function nodeName(node) {\n\treturn nodeNames[node.id] || `Node ${node.id}`;\n}\n\nexport function nodeStatus(node) {\n\tconst { status, notes, panoramas } = node;\n\tconst isActive = status === \"Installed\";\n\tconst isSupernode = notes.toLowerCase().indexOf(\"supernode\") > -1;\n\tconst isHub = notes.toLowerCase().indexOf(\"hub\") > -1;\n\tconst hasPanoramas = panoramas && panoramas.length;\n\n\tif (isActive) {\n\t\tif (isSupernode) return \"supernode\";\n\t\tif (isHub) return \"hub\";\n\t\treturn \"active\";\n\t}\n\n\tif (isSupernode) return \"potential-supernode\";\n\tif (isHub) return \"potential-hub\";\n\tif (hasPanoramas) return \"potential\";\n\treturn \"dead\";\n}\n\nexport const nodeColors = {\n\tactive: \"rgb(255,59,48)\",\n\tdead: \"#aaa\",\n\thub: \"rgb(90,200,250)\",\n\tkiosk: \"#01a2eb\",\n\tlinkNYC: \"#01a2eb\",\n\t\"potential-hub\": \"#777\",\n\t\"potential-supernode\": \"#777\",\n\tpotential: \"#777\",\n\tsupernode: \"#007aff\"\n};\n","import React, { PureComponent } from \"react\";\nimport Highlighter from \"react-highlight-words\";\n\nimport { nodeStatus, nodeName } from \"../utils\";\n\nexport const icons = {\n\tdead: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\">\n\t\t\t<circle\n\t\t\t\tcx=\"7\"\n\t\t\t\tcy=\"7\"\n\t\t\t\tr=\"5\"\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\tfill=\"#aaa\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t),\n\tpotential: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\">\n\t\t\t<circle\n\t\t\t\tcx=\"8\"\n\t\t\t\tcy=\"8\"\n\t\t\t\tr=\"6\"\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\tfill=\"#777\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t),\n\t\"potential-hub\": (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"#777\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"8\"\n\t\t\t\t\tcy=\"10\"\n\t\t\t\t\tcx=\"10\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\t\"potential-supernode\": (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"#777\"\n\t\t\t\t\tstrokeWidth=\"4\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"10\"\n\t\t\t\t\tcy=\"14\"\n\t\t\t\t\tcx=\"14\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\tactive: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<circle\n\t\t\t\tcx=\"10\"\n\t\t\t\tcy=\"10\"\n\t\t\t\tr=\"8\"\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\tfill=\"rgb(255,59,48)\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t),\n\thub: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"rgb(90,200,250)\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"8\"\n\t\t\t\t\tcy=\"10\"\n\t\t\t\t\tcx=\"10\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\tsupernode: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"#007aff\"\n\t\t\t\t\tstrokeWidth=\"4\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"10\"\n\t\t\t\t\tcy=\"14\"\n\t\t\t\t\tcx=\"14\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\tlinkNYC: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<circle\n\t\t\t\tcx=\"10\"\n\t\t\t\tcy=\"10\"\n\t\t\t\tr=\"3\"\n\t\t\t\tstroke=\"white\"\n\t\t\t\tstrokeWidth=\"0\"\n\t\t\t\tfill=\"#01a2eb\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t)\n};\n\nexport default class NodeName extends PureComponent {\n\trender() {\n\t\tconst { node, search } = this.props;\n\t\treturn (\n\t\t\t<div className=\"h1 overflow-visible flex justify-start items-center\">\n\t\t\t\t<div className=\"flex items-center justify-center\">\n\t\t\t\t\t{icons[nodeStatus(node)]}\n\t\t\t\t</div>\n\t\t\t\t<span className=\"fw6 black f5 mv0 ml1\">\n\t\t\t\t\t<Highlighter\n\t\t\t\t\t\thighlightClassName=\"bg-light-yellow\"\n\t\t\t\t\t\tsearchWords={[search]}\n\t\t\t\t\t\tautoEscape={true}\n\t\t\t\t\t\ttextToHighlight={String(nodeName(node))}\n\t\t\t\t\t/>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport NodeName from \"../NodeName\";\n\nexport default class NodeRow extends PureComponent {\n\trender() {\n\t\tconst { node, search, onClick } = this.props;\n\t\tconst { id } = node;\n\t\treturn (\n\t\t\t<Link className=\"link\" to={`/nodes/${id}`}>\n\t\t\t\t<div\n\t\t\t\t\tonClick={onClick}\n\t\t\t\t\tkey={id}\n\t\t\t\t\tclassName=\"pointer hover-bg-near-white bb b--light-gray pa3\"\n\t\t\t\t>\n\t\t\t\t\t<NodeName node={node} search={search} />\n\t\t\t\t</div>\n\t\t\t</Link>\n\t\t);\n\t}\n}\n","import React, { PureComponent } from \"react\";\n\nimport NodeRow from \"./NodeRow\";\n\nexport default class SearchBar extends PureComponent {\n\tstate = {\n\t\tfilteredNodes: [],\n\t\tsearch: \"\",\n\t\tshowDropdown: false\n\t};\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\t// Super hacky, do this better\n\t\tif (\n\t\t\tprevState.search === this.state.search &&\n\t\t\tprevProps.nodes !== this.props.nodes\n\t\t) {\n\t\t\tthis.setState({\n\t\t\t\tfilteredNodes: this.filterSearch(this.state.search)\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"w-100 shadow-2\">\n\t\t\t\t{this.renderSearchBar()}\n\t\t\t\t{this.renderList()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderSearchBar() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"flex items-center bg-white pv3 overflow-hidden\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\tthis.refs.search.focus();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"#aaa\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\tclassName=\"ml3 db\"\n\t\t\t\t\tstyle={{ minWidth: 20 }}\n\t\t\t\t>\n\t\t\t\t\t<circle cx=\"11\" cy=\"11\" r=\"8\" />\n\t\t\t\t\t<line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n\t\t\t\t</svg>\n\t\t\t\t<input\n\t\t\t\t\tref=\"search\"\n\t\t\t\t\tclassName=\"h1 overflow-hidden pl2 pr3 input-reset f5 fw4 bw0 w-100 on\"\n\t\t\t\t\tvalue={this.state.search}\n\t\t\t\t\tplaceholder=\"Search nodes\"\n\t\t\t\t\tspellCheck={false}\n\t\t\t\t\tautoCorrect=\"false\"\n\t\t\t\t\tonFocus={() => this.setState({ showDropdown: true })}\n\t\t\t\t\tonChange={event =>\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tsearch: event.target.value,\n\t\t\t\t\t\t\tfilteredNodes: this.filterSearch(event.target.value)\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t{this.renderClearButton()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderList() {\n\t\tif (!this.state.filteredNodes.length || !this.state.showDropdown) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { search } = this.state;\n\t\treturn (\n\t\t\t<div className=\"bg-white bt b--light-gray max-h-5-rows overflow-y-scroll\">\n\t\t\t\t{this.state.filteredNodes.map(node => (\n\t\t\t\t\t<NodeRow\n\t\t\t\t\t\tkey={node.id}\n\t\t\t\t\t\tnode={node}\n\t\t\t\t\t\tsearch={search}\n\t\t\t\t\t\ticonColor={this.colorForNode(node)}\n\t\t\t\t\t\tonClick={() => this.setState({ showDropdown: false })}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderClearButton() {\n\t\tconst { search } = this.state;\n\n\t\tif (!search || !search.length) {\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"mr3\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: 20,\n\t\t\t\t\t\theight: 20\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\tonClick={() => {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tsearch: \"\",\n\t\t\t\t\t\tfilteredNodes: []\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t\tclassName=\"on btn bn pa0 bg-white pointer mr3 silver\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\tclassName=\"db\"\n\t\t\t\t>\n\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t);\n\t}\n\n\tfilterSearch(search) {\n\t\tconst { nodes } = this.props;\n\t\tif (!search) {\n\t\t\treturn [];\n\t\t}\n\t\treturn [\n\t\t\t...nodes.filter(node => node.id === parseInt(search, 10)),\n\t\t\t...nodes\n\t\t\t\t.filter(\n\t\t\t\t\tnode =>\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tnode.name,\n\t\t\t\t\t\t\tnode.location,\n\t\t\t\t\t\t\tnode.notes,\n\t\t\t\t\t\t\tnode.status,\n\t\t\t\t\t\t\tnode.email\n\t\t\t\t\t\t]\n\t\t\t\t\t\t\t.join(\" \")\n\t\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t\t.indexOf(search.toLowerCase()) > -1\n\t\t\t\t)\n\t\t\t\t.sort((a, b) => {\n\t\t\t\t\tif (a.status !== b.status) {\n\t\t\t\t\t\tif (a.status === \"Installed\") return -1;\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.id - b.id;\n\t\t\t\t})\n\t\t];\n\t}\n\n\tcolorForNode(node) {\n\t\tconst { status, tickets } = node;\n\t\treturn status === \"Installed\"\n\t\t\t? \"rgb(255,59,48)\"\n\t\t\t: tickets && tickets.length > 2\n\t\t\t\t? \"rgb(255,204,0)\"\n\t\t\t\t: \"gray\";\n\t}\n}\n","import { connect } from \"react-redux\";\nimport PureSearchBar from \"./component\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.nodes,\n\ttickets: state.tickets\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureSearchBar);\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Marker } from \"react-google-maps\";\nimport { withRouter } from \"react-router\";\n\nimport { nodeStatus } from \"../../utils\";\n\nclass NodeMarker extends PureComponent {\n\tstatic contextTypes = {\n\t\trouter: PropTypes.object\n\t};\n\n\trender() {\n\t\tconst { node } = this.props;\n\t\tconst { history } = this.context.router;\n\t\tconst { id } = node;\n\t\tconst [lng, lat] = node.coordinates;\n\t\tconst { icon, zIndex } = this.getMarkerProps();\n\n\t\treturn (\n\t\t\t<Marker\n\t\t\t\tdefaultPosition={{ lat, lng }}\n\t\t\t\ticon={icon}\n\t\t\t\toptions={{ opacity: this.getOpacity() }}\n\t\t\t\tzIndex={this.getZIndex(zIndex)}\n\t\t\t\tonClick={() => history.push(`/nodes/${id}`)}\n\t\t\t/>\n\t\t);\n\t}\n\n\tgetOpacity() {\n\t\tconst { visibility } = this.props;\n\t\tif (visibility === \"highlight\") return 1;\n\t\tif (visibility === \"dim\") return 0.25;\n\t\treturn 1;\n\t}\n\n\tgetZIndex(defaultZIndex) {\n\t\tconst { visibility } = this.props;\n\t\tif (visibility === \"highlight\") return 999;\n\t\treturn defaultZIndex;\n\t}\n\n\tgetMarkerProps() {\n\t\tconst { node } = this.props;\n\n\t\tconst status = nodeStatus(node);\n\n\t\tif (status === \"supernode\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/supernode.svg\",\n\t\t\t\t\tanchor: { x: 14, y: 14 }\n\t\t\t\t},\n\t\t\t\tzIndex: 100\n\t\t\t};\n\n\t\tif (status === \"hub\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/hub.svg\",\n\t\t\t\t\tanchor: { x: 10, y: 10 }\n\t\t\t\t},\n\t\t\t\tzIndex: 99\n\t\t\t};\n\n\t\tif (status === \"active\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/active.svg\",\n\t\t\t\t\tanchor: { x: 10, y: 10 }\n\t\t\t\t},\n\t\t\t\tzIndex: 98\n\t\t\t};\n\n\t\tif (status === \"potential-supernode\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/potential-supernode.svg\",\n\t\t\t\t\tanchor: { x: 14, y: 14 }\n\t\t\t\t},\n\t\t\t\tzIndex: 89\n\t\t\t};\n\n\t\tif (status === \"potential-hub\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/potential-hub.svg\",\n\t\t\t\t\tanchor: { x: 10, y: 10 }\n\t\t\t\t},\n\t\t\t\tzIndex: 88\n\t\t\t};\n\n\t\tif (status === \"potential\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/potential.svg\",\n\t\t\t\t\tanchor: { x: 8, y: 8 }\n\t\t\t\t},\n\t\t\t\tzIndex: 87\n\t\t\t};\n\n\t\treturn {\n\t\t\ticon: {\n\t\t\t\turl: \"/img/map/dead.svg\",\n\t\t\t\tanchor: { x: 7, y: 7 }\n\t\t\t},\n\t\t\tzIndex: 86\n\t\t};\n\t}\n}\n\nconst RouterNodeMarker = withRouter(NodeMarker);\n\nexport default class CombinedMarker extends PureComponent {\n\tstate = {\n\t\tvisibility: \"default\"\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<RouterNodeMarker\n\t\t\t\t{...this.props}\n\t\t\t\tvisibility={this.state.visibility}\n\t\t\t/>\n\t\t);\n\t}\n\n\tsetVisibility(visibility) {\n\t\tthis.setState({ visibility });\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Marker } from \"react-google-maps\";\n\nexport default class KioskMarker extends PureComponent {\n\trender() {\n\t\tconst { kiosk } = this.props;\n\t\tconst [lng, lat] = kiosk.coordinates;\n\t\tconst icon = {\n\t\t\turl: \"/img/map/kiosk.svg\",\n\t\t\tanchor: { x: 5, y: 5 }\n\t\t};\n\t\treturn <Marker defaultPosition={{ lat, lng }} icon={icon} zIndex={1} />;\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Polyline } from \"react-google-maps\";\n\nexport default class LinkLine extends PureComponent {\n\tstate = {\n\t\tvisibility: \"default\"\n\t};\n\n\trender() {\n\t\tconst { link } = this.props;\n\n\t\tconst [start, end] = link.coordinates;\n\t\tconst [lng1, lat1] = start;\n\t\tconst [lng2, lat2] = end;\n\t\tconst latlng1 = { lat: lat1, lng: lng1 };\n\t\tconst latlng2 = { lat: lat2, lng: lng2 };\n\n\t\tconst { strokeColor, strokeOpacity, zIndex } = this.getLineProps();\n\n\t\treturn (\n\t\t\t<Polyline\n\t\t\t\tpath={[latlng1, latlng2]}\n\t\t\t\toptions={{\n\t\t\t\t\tstrokeColor,\n\t\t\t\t\tstrokeOpacity: this.getOpacity(strokeOpacity)\n\t\t\t\t}}\n\t\t\t\tzIndex={this.getZIndex(zIndex)}\n\t\t\t/>\n\t\t);\n\t}\n\n\tgetOpacity(defaultOpacity) {\n\t\tconst { visibility } = this.state;\n\t\tif (visibility === \"highlight\") return 1;\n\t\tif (visibility === \"dim\") return defaultOpacity * 0.25;\n\t\treturn defaultOpacity;\n\t}\n\n\tgetZIndex(defaultZIndex) {\n\t\tconst { visibility } = this.state;\n\t\tif (visibility === \"highlight\") return 60;\n\t\treturn defaultZIndex;\n\t}\n\n\tsetVisibility(visibility) {\n\t\tthis.setState({ visibility });\n\t}\n\n\tgetLineProps() {\n\t\tconst { link } = this.props;\n\t\tconst { status } = link;\n\n\t\tif (status === \"active\")\n\t\t\treturn {\n\t\t\t\tstrokeColor: \"#007aff\",\n\t\t\t\tstrokeOpacity: 1,\n\t\t\t\tzIndex: 50\n\t\t\t};\n\n\t\treturn {\n\t\t\tstrokeColor: \"#aaa\",\n\t\t\tstrokeOpacity: 0.25,\n\t\t\tzIndex: 50\n\t\t};\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Polygon } from \"react-google-maps\";\n\nexport default class LinkLine extends PureComponent {\n\trender() {\n\t\tconst { lat, lng, r, azimuth, width, potential } = this.props;\n\t\tvar centerPoint = { lat, lng };\n\t\tvar PRlat = r / 3963 * (180 / Math.PI); // using 3963 miles as earth's radius\n\t\tvar PRlng = PRlat / Math.cos(lat * (Math.PI / 180));\n\t\tvar PGpoints = [];\n\t\tPGpoints.push(centerPoint);\n\n\t\tconst lat1 =\n\t\t\tlat + PRlat * Math.cos(Math.PI / 180 * (azimuth - width / 2));\n\t\tconst lon1 =\n\t\t\tlng + PRlng * Math.sin(Math.PI / 180 * (azimuth - width / 2));\n\t\tPGpoints.push({ lat: lat1, lng: lon1 });\n\n\t\tconst lat2 =\n\t\t\tlat + PRlat * Math.cos(Math.PI / 180 * (azimuth + width / 2));\n\t\tconst lon2 =\n\t\t\tlng + PRlng * Math.sin(Math.PI / 180 * (azimuth + width / 2));\n\n\t\tvar theta = 0;\n\t\tvar gamma = Math.PI / 180 * (azimuth + width / 2);\n\n\t\tfor (var a = 1; theta < gamma; a++) {\n\t\t\ttheta = Math.PI / 180 * (azimuth - width / 2 + a);\n\t\t\tconst PGlon = lng + PRlng * Math.sin(theta);\n\t\t\tconst PGlat = lat + PRlat * Math.cos(theta);\n\n\t\t\tPGpoints.push({ lat: PGlat, lng: PGlon });\n\t\t}\n\n\t\tPGpoints.push({ lat: lat2, lng: lon2 });\n\t\tPGpoints.push(centerPoint);\n\n\t\tconst fillOpacity = 0.15;\n\n\t\treturn (\n\t\t\t<Polygon\n\t\t\t\tpath={PGpoints}\n\t\t\t\tdefaultOptions={{\n\t\t\t\t\tstrokeColor: \"transparent\",\n\t\t\t\t\tstrokeOpacity: 0,\n\t\t\t\t\tstrokeWidth: 0,\n\t\t\t\t\tfillColor: potential ? \"#777\" : \"#007aff\",\n\t\t\t\t\tfillOpacity,\n\t\t\t\t\tclickable: false\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport InfoBox from \"react-google-maps/lib/components/addons/InfoBox\";\nimport { Link } from \"react-router-dom\";\n\nimport { nodeName } from \"../../utils\";\n\nexport default class NodeDetail extends PureComponent {\n\trender() {\n\t\tif (!this.props.match) return null;\n\n\t\tconst { match, nodes } = this.props;\n\n\t\tconst matchingNodes = nodes.filter(\n\t\t\tnode => node.id === parseInt(match.params.nodeId, 10)\n\t\t);\n\n\t\tif (!matchingNodes.length) return null;\n\n\t\tconst node = matchingNodes[0];\n\t\tconst { coordinates } = node;\n\t\tconst [lng, lat] = coordinates;\n\n\t\treturn (\n\t\t\t<InfoBox\n\t\t\t\tposition={new window.google.maps.LatLng(lat, lng)}\n\t\t\t\toptions={{\n\t\t\t\t\tboxStyle: { overflow: \"visible\" },\n\t\t\t\t\tboxClass: \"overflow-visible pointer-events-none\",\n\t\t\t\t\talignBottom: true,\n\t\t\t\t\tcloseBoxURL: ``,\n\t\t\t\t\tenableEventPropagation: false\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmarginLeft: \"-50%\",\n\t\t\t\t\t\tmarginRight: \"50%\"\n\t\t\t\t\t}}\n\t\t\t\t\tclassName=\"mb1 flex flex-column items-center pointer-events-all\"\n\t\t\t\t>\n\t\t\t\t\t<div className=\"flex items-center bg-white br2 overflow-hidden shadow-2\">\n\t\t\t\t\t\t{this.renderImage(node)}\n\t\t\t\t\t\t<div className=\"pv1 ph2\">\n\t\t\t\t\t\t\t<span className=\"f5 fw6 nowrap sans-serif\">\n\t\t\t\t\t\t\t\t{nodeName(node)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<svg\n\t\t\t\t\t\tviewBox=\"0 5 12 12\"\n\t\t\t\t\t\tversion=\"1.1\"\n\t\t\t\t\t\twidth=\"12\"\n\t\t\t\t\t\theight=\"12\"\n\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\t\t\t\tfill=\"white\"\n\t\t\t\t\t\t\td=\"M0 5l6 6 6-6H0z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</InfoBox>\n\t\t);\n\t}\n\n\trenderImage(node) {\n\t\tconst { id, panoramas } = node;\n\t\tif (!panoramas || !panoramas.length) {\n\t\t\treturn null;\n\t\t}\n\t\tconst [firstPanorama] = panoramas;\n\t\treturn (\n\t\t\t<Link to={`/nodes/${id}/panoramas/1`} className=\"db node-image\">\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"h-100 w-100 cover bg-center bg-near-white\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tbackgroundImage: `url(\"/img/panorama/${firstPanorama}\")`\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</Link>\n\t\t);\n\t}\n}\n","import { connect } from \"react-redux\";\nimport PureComponent from \"./component\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.nodes\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureComponent);\n","import React, { Component, Fragment } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { withScriptjs, withGoogleMap, GoogleMap } from \"react-google-maps\";\nimport { withRouter } from \"react-router\";\nimport PropTypes from \"prop-types\";\n\nimport NodeMarker from \"./NodeMarker\";\nimport KioskMarker from \"./KioskMarker\";\nimport LinkLine from \"./LinkLine\";\nimport Sector from \"./Sector\";\nimport NodeDetail from \"../NodeDetail\";\n\nimport { mapStyles } from \"./styles\";\n\nconst options = {\n\tstyles: mapStyles,\n\tfullscreenControl: false,\n\tstreetViewControl: false,\n\tzoomControlOptions: {\n\t\tposition: \"9\"\n\t},\n\tmapTypeControlOptions: {\n\t\tposition: \"3\"\n\t},\n\tbackgroundColor: \"#f5f5f5\",\n\tgestureHandling: \"greedy\",\n\tclickableIcons: false\n};\n\nconst MapComponent = withScriptjs(\n\twithGoogleMap(props => (\n\t\t<GoogleMap ref={props.mapRef} {...props}>\n\t\t\t{props.children}\n\t\t</GoogleMap>\n\t))\n);\n\nclass MapView extends Component {\n\tstatic contextTypes = {\n\t\trouter: PropTypes.object\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.map = React.createRef();\n\t\tthis.markerRefs = {};\n\t\tthis.lineRefs = {};\n\t}\n\n\tcomponentDidMount() {\n\t\tif (this.props.match) {\n\t\t\ttry {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (!this.props.match) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst selectedNodeId = parseInt(\n\t\t\t\t\t\tthis.props.match.params.nodeId,\n\t\t\t\t\t\t10\n\t\t\t\t\t);\n\t\t\t\t\tconst selectedMarker = this.markerRefs[selectedNodeId];\n\t\t\t\t\tif (!selectedMarker) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { node: selectedNode } = selectedMarker.props;\n\t\t\t\t\tthis.updateNodes(selectedNode, selectedMarker);\n\t\t\t\t\tthis.updateLinks(selectedNode);\n\t\t\t\t\tthis.panToNode(selectedNode);\n\t\t\t\t}, 500);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(\":(\");\n\t\t\t}\n\t\t}\n\t}\n\n\t// This is a kinda hacky way to improve performance\n\t// Instead of rerending the entire map, rerender specific nodes\n\tshouldComponentUpdate(nextProps) {\n\t\tif (this.props.nodes !== nextProps.node) {\n\t\t\tthis.handleSelectedChange(nextProps);\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thandleSelectedChange(nextProps) {\n\t\t// If selected node is unchanged, do not rerender\n\t\tif (!this.props.match && !nextProps.match) return false;\n\n\t\t// If one was selected but none now selected, reset all nodes\n\t\tif (!nextProps.match) {\n\t\t\tthis.resetAllNodes();\n\t\t\treturn false;\n\t\t}\n\n\t\tconst nextSelectedNodeId = parseInt(nextProps.match.params.nodeId, 10);\n\t\tconst nextSelectedMarker = this.markerRefs[nextSelectedNodeId];\n\n\t\tif (!nextSelectedMarker) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { node: nextSelectedNode } = nextSelectedMarker.props;\n\n\t\tthis.updateNodes(nextSelectedNode, nextSelectedMarker);\n\t\tthis.updateLinks(nextSelectedNode);\n\t\tthis.panToNode(nextSelectedNode);\n\t}\n\n\trender() {\n\t\tconst { history } = this.context.router;\n\t\treturn (\n\t\t\t<MapComponent\n\t\t\t\tmapRef={this.map}\n\t\t\t\tdefaultZoom={13}\n\t\t\t\tdefaultCenter={{ lat: 40.7101809, lng: -73.9595798 }}\n\t\t\t\tdefaultOptions={options}\n\t\t\t\tonClick={() => history.push(\"/\")}\n\t\t\t\tgoogleMapURL=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBNClp7oJsw-eleEoR3-PQKV23tpeW-FpE\"\n\t\t\t\tloadingElement={<div className=\"h-100 bg-map-beige\" />}\n\t\t\t\tcontainerElement={<div className=\"h-100 bg-map-beige\" />}\n\t\t\t\tmapElement={<div className=\"h-100 bg-map-beige\" />}\n\t\t\t>\n\t\t\t\t{this.renderSectors()}\n\t\t\t\t{this.renderLinks()}\n\t\t\t\t{this.renderKiosks()}\n\t\t\t\t{this.renderNodes()}\n\t\t\t\t<NodeDetail match={this.props.match} />\n\t\t\t</MapComponent>\n\t\t);\n\t}\n\n\trenderNodes() {\n\t\tconst { nodes, selectNode } = this.props;\n\t\treturn nodes.map(node => (\n\t\t\t<NodeMarker\n\t\t\t\tkey={node.id}\n\t\t\t\tref={ref => {\n\t\t\t\t\tthis.handleMarkerRef(ref);\n\t\t\t\t}}\n\t\t\t\tnode={node}\n\t\t\t\tselectNode={selectNode}\n\t\t\t/>\n\t\t));\n\t}\n\n\trenderKiosks() {\n\t\tconst { kiosks } = this.props;\n\t\treturn kiosks.map(kiosk => (\n\t\t\t<KioskMarker key={kiosk.id} kiosk={kiosk} />\n\t\t));\n\t}\n\n\trenderLinks() {\n\t\tconst { links } = this.props;\n\t\treturn links.map((link, index) => (\n\t\t\t<LinkLine\n\t\t\t\tkey={this.linkId(link)}\n\t\t\t\tref={ref => {\n\t\t\t\t\tthis.handleLineRef(ref);\n\t\t\t\t}}\n\t\t\t\tlink={link}\n\t\t\t/>\n\t\t));\n\t}\n\n\trenderSectors() {\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<Sector\n\t\t\t\t\tlat={40.711137}\n\t\t\t\t\tlng={-74.001122}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={55}\n\t\t\t\t\twidth={90}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tlat={40.713991}\n\t\t\t\t\tlng={-73.929049}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={180}\n\t\t\t\t\twidth={220}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tlat={40.685823}\n\t\t\t\t\tlng={-73.917272}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={180}\n\t\t\t\t\twidth={360}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tpotential={true}\n\t\t\t\t\tlat={40.657867}\n\t\t\t\t\tlng={-74.004904}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={40}\n\t\t\t\t\twidth={120}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tpotential={true}\n\t\t\t\t\tlat={40.657867}\n\t\t\t\t\tlng={-74.004904}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={160}\n\t\t\t\t\twidth={120}\n\t\t\t\t/>\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\tresetAllNodes() {\n\t\tReactDOM.unstable_batchedUpdates(() => {\n\t\t\tObject.values(this.markerRefs).forEach(marker =>\n\t\t\t\tmarker.setVisibility(\"default\")\n\t\t\t);\n\n\t\t\tObject.values(this.lineRefs).forEach(line =>\n\t\t\t\tline.setVisibility(\"default\")\n\t\t\t);\n\t\t});\n\t}\n\n\tupdateNodes(node, marker) {\n\t\tReactDOM.unstable_batchedUpdates(() => {\n\t\t\t// Dim all nodes of same type\n\n\t\t\t// TODO: optimize performance by only resetting selected nodes\n\t\t\t// (selected node and all nodes of opposite type)\n\t\t\tObject.values(this.markerRefs).forEach(marker => {\n\t\t\t\tif (node.status === \"Installed\") {\n\t\t\t\t\tif (node.id !== marker.props.node.id) {\n\t\t\t\t\t\tmarker.setVisibility(\"dim\");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (marker.props.node.status === \"Installed\") {\n\t\t\t\t\t\tmarker.setVisibility(\"default\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarker.setVisibility(\"dim\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Highlight selected node\n\t\t\tmarker.setVisibility(\"highlight\");\n\n\t\t\t// Highlight directly connected nodes\n\t\t\tnode.connectedNodes &&\n\t\t\t\tObject.keys(node.connectedNodes).forEach(connectedNodeId => {\n\t\t\t\t\tconst connectedMarker = this.markerRefs[connectedNodeId];\n\t\t\t\t\tif (connectedMarker) {\n\t\t\t\t\t\tconnectedMarker.setVisibility(\"highlight\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\t}\n\n\tupdateLinks(node) {\n\t\t// Dim all links\n\t\tObject.values(this.lineRefs).forEach(line => line.setVisibility(\"dim\"));\n\n\t\t// Highlight direct links\n\t\tnode.links.forEach(link => {\n\t\t\tconst line = this.lineRefs[this.linkId(link)];\n\t\t\tif (line) {\n\t\t\t\tline.setVisibility(\"highlight\");\n\t\t\t}\n\t\t});\n\t}\n\n\tpanToNode(node) {\n\t\t// TODO: only if out of viewport\n\t\tconst [lng, lat] = node.coordinates;\n\t\tthis.map.current.panTo({ lat, lng });\n\t}\n\n\thandleMarkerRef(ref) {\n\t\tif (ref) {\n\t\t\tthis.markerRefs[ref.props.node.id] = ref;\n\t\t}\n\t}\n\n\thandleLineRef(ref) {\n\t\tif (ref) {\n\t\t\tthis.lineRefs[this.linkId(ref.props.link)] = ref;\n\t\t}\n\t}\n\n\tlinkId(link) {\n\t\treturn `${link.from.toString()}-${link.to.toString()} ${\n\t\t\tlink.coordinates\n\t\t} ${link.status}`;\n\t}\n}\n\nexport default withRouter(MapView);\n","export const mapStyles = [\n\t// {\n\t// \tfeatureType: \"landscape\",\n\t// \telementType: \"geometry\",\n\t// \tstylers: [\n\t// \t\t{\n\t// \t\t\tcolor: \"#f5f5f5\"\n\t// \t\t}\n\t// \t]\n\t// },\n\t// {\n\t// \tfeatureType: \"poi.park\",\n\t// \telementType: \"geometry\",\n\t// \tstylers: [{ color: \"#e4f6dd\" }]\n\t// },\n\t{\n\t\telementType: \"labels.icon\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t},\n\t// {\n\t// \telementType: \"labels.text.stroke\",\n\t// \tstylers: [\n\t// \t\t{\n\t// \t\t\tcolor: \"#f5f5f5\"\n\t// \t\t}\n\t// \t]\n\t// },\n\t// {\n\t// \tfeatureType: \"road\",\n\t// \telementType: \"geometry\",\n\t// \tstylers: [\n\t// \t\t{\n\t// \t\t\tcolor: \"#ffffff\"\n\t// \t\t}\n\t// \t]\n\t// },\n\t{\n\t\tfeatureType: \"road\",\n\t\telementType: \"labels.icon\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tfeatureType: \"road.highway\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tfeatureType: \"transit\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t}\n\t// {\n\t// \tfeatureType: \"water\",\n\t// \telementType: \"geometry\",\n\t// \tstylers: [\n\t// \t\t{\n\t// \t\t\tcolor: \"#d9dde6\"\n\t// \t\t}\n\t// \t]\n\t// }\n];\n","import { connect } from \"react-redux\";\nimport PureMapView from \"./component\";\n\nimport { selectNode } from \"../../actions\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.filteredNodes,\n\tlinks: state.filteredLinks,\n\tkiosks: state.kiosks,\n\ttickets: state.tickets\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n\tselectNode: node => selectNode(node, dispatch)\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureMapView);\n","export function selectNode(node, dispatch) {\n\tdispatch({ type: \"SELECT_NODE\", node });\n}\n\nexport function toggleFilter(label, dispatch) {\n\tdispatch({ type: \"TOGGLE_FILTER\", label });\n}\n","import React, { PureComponent } from \"react\";\n\nimport { icons } from \"../NodeName\";\nimport { nodeColors } from \"../../utils\";\n\n// This should be defined elsewhere\nconst labels = [\"active\", \"potential\", \"supernode\", \"hub\", \"linkNYC\"];\n\nexport default class Filters extends PureComponent {\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"bg-white shadow-2\">\n\t\t\t\t<div role=\"group\" className=\"dib pa2\">\n\t\t\t\t\t<div>{labels.map(label => this.renderFilter(label))}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderFilter(label) {\n\t\tconst { filters, statusCounts, toggleFilter } = this.props;\n\t\tconst opacity =\n\t\t\tfilters[label] || filters[label] === undefined\n\t\t\t\t? \"o-100\"\n\t\t\t\t: \"o-50 strike\";\n\t\treturn (\n\t\t\t<div key={label} className={`pointer ${opacity}`}>\n\t\t\t\t<input\n\t\t\t\t\tclassName=\"ma0 mr1 dn\"\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tid={label}\n\t\t\t\t\tname=\"feature\"\n\t\t\t\t\tvalue={label}\n\t\t\t\t\tdefaultChecked={true}\n\t\t\t\t/>\n\t\t\t\t<label\n\t\t\t\t\thtmlFor={label}\n\t\t\t\t\tstyle={{ color: nodeColors[label] }}\n\t\t\t\t\tclassName=\"ttc pointer flex items-center nowrap\"\n\t\t\t\t\tonClick={() => toggleFilter(label)}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tmarginLeft: \"-0.5rem\",\n\t\t\t\t\t\t\tmarginRight: \"-0.25rem\",\n\t\t\t\t\t\t\tmarginTop: \"-0.125rem\",\n\t\t\t\t\t\t\tmarginBottom: \"-0.125rem\"\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName=\"h2 w2 flex items-center justify-center\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{icons[label]}\n\t\t\t\t\t</div>\n\t\t\t\t\t<span className=\"ml1\">\n\t\t\t\t\t\t{label.replace(\"-\", \" \")} ({statusCounts[label]})\n\t\t\t\t\t</span>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import { connect } from \"react-redux\";\nimport PureFilters from \"./component\";\n\nimport { toggleFilter } from \"../../actions\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tfilters: state.filters,\n\tstatusCounts: state.statusCounts\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n\ttoggleFilter: label => toggleFilter(label, dispatch)\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureFilters);\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Link } from \"react-router-dom\";\nimport DocumentTitle from \"react-document-title\";\n\nexport default class Gallery extends PureComponent {\n\tstatic contextTypes = {\n\t\trouter: PropTypes.object\n\t};\n\n\tcomponentDidMount() {\n\t\tthis.keyDownHandler = this.handleKeyDown.bind(this);\n\t\twindow.addEventListener(\"keydown\", this.keyDownHandler, false);\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener(\"keydown\", this.keyDownHandler, false);\n\t}\n\n\thandleKeyDown(event) {\n\t\tif (event.keyCode === 27) {\n\t\t\tconst { match } = this.props;\n\t\t\tconst { nodeId } = match.params;\n\t\t\tconst { history } = this.context.router;\n\t\t\thistory.push(`/nodes/${nodeId}`);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { match, nodes } = this.props;\n\t\tconst { nodeId, panoId } = match.params;\n\t\tconst matchingNodes = nodes.filter(\n\t\t\tnode => node.id === parseInt(nodeId, 10)\n\t\t);\n\t\tif (!matchingNodes || !matchingNodes.length) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { panoramas } = matchingNodes[0];\n\t\tif (!panoramas || !panoramas.length) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst src = panoramas[panoId - 1];\n\n\t\treturn (\n\t\t\t<DocumentTitle\n\t\t\t\ttitle={`Panorama ${panoId} - Node ${nodeId} - NYC Mesh`}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tonKeyDown={e => this.onKeyPressed(e)}\n\t\t\t\t\tclassName=\"fixed absolute--fill bg-black flex items-center justify-center z-max\"\n\t\t\t\t>\n\t\t\t\t\t<Link to=\"..\" className=\"absolute top-0 left-0 ma3 white\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tclassName=\"db ma0\"\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstrokeWidth=\"3\"\n\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n\t\t\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</Link>\n\n\t\t\t\t\t<img\n\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\twindow\n\t\t\t\t\t\t\t\t.open(`/img/panorama/${src}`, \"_blank\")\n\t\t\t\t\t\t\t\t.focus()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclassName=\"db center mh-100 mw-100 zoom-in\"\n\t\t\t\t\t\tsrc={`/img/panorama/${src}`}\n\t\t\t\t\t\talt=\"Panorama\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</DocumentTitle>\n\t\t);\n\t}\n\n\tonKeyPressed(e) {\n\t\tconsole.log(e.key);\n\t}\n}\n","import { connect } from \"react-redux\";\nimport PureGallery from \"./component\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.nodes\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureGallery);\n","import { parse } from \"date-fns\";\n\n// TODO: Get this client side, using auth tokens\nimport active from \"../data/active.json\";\nimport potential from \"../data/potential.json\";\nimport links from \"../data/links.json\";\nimport kiosks from \"../data/kiosks.json\";\n\nimport { nodeStatus } from \"../utils\";\n\n// Calculate connected nodes for each node\nactive.forEach(node => {\n\tconst connectedNodes = { [node.id]: true };\n\n\tlinks.forEach(link => {\n\t\tif (link.status !== \"active\") return;\n\t\tif (link.from === parseInt(node.id, 10)) {\n\t\t\tconnectedNodes[link.to] = true;\n\t\t}\n\n\t\tif (link.to === parseInt(node.id, 10)) {\n\t\t\tconnectedNodes[link.from] = true;\n\t\t}\n\t});\n\n\tnode.connectedNodes = connectedNodes;\n});\n\nconst nodes = [...active, ...potential].sort(sortNodes);\nconst nodeMap = {};\nconst statusCounts = { linkNYC: kiosks.length };\n\nnodes.forEach(node => {\n\t// Calculate status counts\n\tconst status = nodeStatus(node);\n\tif (status.indexOf(\"potential\") > -1 || status === \"dead\") {\n\t\tstatusCounts.potential = (statusCounts.potential || 0) + 1;\n\t} else {\n\t\tstatusCounts[status] = (statusCounts[status] || 0) + 1;\n\t}\n\n\t// Add links to node\n\tnode.links = links.filter(\n\t\tlink =>\n\t\t\tlink.status === \"active\" &&\n\t\t\t(link.from === parseInt(node.id, 10) ||\n\t\t\t\tlink.to === parseInt(node.id, 10))\n\t);\n\n\tnodeMap[node.id] = node;\n});\n\nlinks.forEach(link => {\n\tlink.fromNode = nodeMap[link.from];\n\tlink.toNode = nodeMap[link.to];\n});\n\nconst initialFilters = {};\n\nconst initialState = {\n\tnodes,\n\tlinks,\n\tkiosks,\n\tfilteredNodes: filterNodes(nodes, initialFilters),\n\tfilteredLinks: filterLinks(links, initialFilters),\n\tfilters: initialFilters,\n\tstatusCounts\n};\n\nconst reducer = (state = initialState, action) => {\n\tswitch (action.type) {\n\t\tcase \"TOGGLE_FILTER\":\n\t\t\tconst newFilters = {\n\t\t\t\t...state.filters,\n\t\t\t\t[action.label]:\n\t\t\t\t\tstate.filters[action.label] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[action.label]\n\t\t\t};\n\t\t\tif (action.label === \"potential\") {\n\t\t\t\tnewFilters[\"dead\"] =\n\t\t\t\t\tstate.filters[\"dead\"] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[\"dead\"];\n\t\t\t\tnewFilters[\"potential-hub\"] =\n\t\t\t\t\tstate.filters[\"potential-hub\"] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[\"potential-hub\"];\n\t\t\t\tnewFilters[\"potential-supernode\"] =\n\t\t\t\t\tstate.filters[\"potential-supernode\"] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[\"potential-supernode\"];\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tfilters: newFilters,\n\t\t\t\tfilteredNodes: filterNodes(nodes, newFilters),\n\t\t\t\tfilteredLinks: filterLinks(links, newFilters),\n\t\t\t\tkiosks: newFilters.linkNYC === false ? [] : kiosks\n\t\t\t};\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n\nfunction filterNodes(nodes, filters) {\n\treturn nodes.filter(\n\t\tnode =>\n\t\t\tfilters[nodeStatus(node)] === undefined || filters[nodeStatus(node)]\n\t);\n}\n\nfunction filterLinks(links, filters) {\n\treturn links.filter(link => {\n\t\tif (\n\t\t\tfilters[nodeStatus(link.fromNode)] !== undefined &&\n\t\t\tfilters[nodeStatus(link.fromNode)] === false\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tfilters[nodeStatus(link.toNode)] !== undefined &&\n\t\t\tfilters[nodeStatus(link.toNode)] === false\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n}\n\nfunction sortNodes(a, b, reverse = true) {\n\tconst keyA = parse(a.id),\n\t\tkeyB = parse(b.id);\n\tif (keyA < keyB) return reverse ? 1 : -1;\n\tif (keyA > keyB) return reverse ? -1 : 1;\n\treturn 0;\n}\n\nexport default reducer;\n","import { createStore } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport DocumentTitle from \"react-document-title\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\n\nimport React, { Component } from \"react\";\nimport SearchBar from \"./components/SearchBar\";\nimport MapView from \"./components/MapView\";\nimport Filters from \"./components/Filters\";\nimport Gallery from \"./components/Gallery\";\n\nimport rootReducer from \"./reducers\";\n\nconst store = createStore(rootReducer);\n\nclass App extends Component {\n\trender() {\n\t\treturn (\n\t\t\t<DocumentTitle title=\"Map - NYC Mesh\">\n\t\t\t\t<Provider store={store}>\n\t\t\t\t\t<Router basename={\"/map\"}>\n\t\t\t\t\t\t<div className=\"vh-75 sans-serif\">\n\t\t\t\t\t\t\t<div className=\"h-100 w-100 relative\">\n\t\t\t\t\t\t\t\t<div className=\"absolute pa2 z-999 search-bar\">\n\t\t\t\t\t\t\t\t\t<SearchBar />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\t\t\tpath=\"/nodes/:nodeId\"\n\t\t\t\t\t\t\t\t\tchildren={({ match }) => (\n\t\t\t\t\t\t\t\t\t\t<MapView match={match} />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<div className=\"absolute bottom-0 left-0 ma2\">\n\t\t\t\t\t\t\t\t\t<Filters />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\t\tpath=\"/nodes/:nodeId/panoramas/:panoId\"\n\t\t\t\t\t\t\t\tcomponent={Gallery}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Router>\n\t\t\t\t</Provider>\n\t\t\t</DocumentTitle>\n\t\t);\n\t}\n\n\thandleNodeClick(node) {}\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"map-root\"));\n"],"sourceRoot":""}