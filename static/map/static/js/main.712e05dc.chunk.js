(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{163:function(e,t,n){e.exports=n(372)},168:function(e,t,n){},372:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(29),o=n.n(i),s=(n(168),n(4)),l=n(5),c=n(7),u=n(6),h=n(8),d=n(69),f=n(22),p=n(70),m=n.n(p),v=n(376),b=n(375),k=n(101),y=n(373),g=n(158),w=n.n(g),E={227:"Supernode 1",570:"Supernode 2",713:"Supernode 3"};function O(e){return E[e.id]||"Node ".concat(e.id)}function j(e){var t=e.status,n=e.notes,a=e.panoramas,r="Installed"===t,i=n&&n.toLowerCase().indexOf("supernode")>-1,o=n&&n.toLowerCase().indexOf("hub")>-1,s=a&&a.length;return r?i?"supernode":o?"hub":"active":i?"potential-supernode":o?"potential-hub":s?"potential":"dead"}var x={active:"rgb(255,59,48)",dead:"#aaa",hub:"rgb(90,200,250)",kiosk:"#01a2eb",linkNYC:"#01a2eb","potential-hub":"#777","potential-supernode":"#777",potential:"#777",supernode:"#007aff"},C={dead:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14"},r.a.createElement("circle",{cx:"7",cy:"7",r:"5",stroke:"#fff",strokeWidth:"2",fill:"#aaa",opacity:"1"})),potential:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},r.a.createElement("circle",{cx:"8",cy:"8",r:"6",stroke:"#fff",strokeWidth:"2",fill:"#777",opacity:"1"})),"potential-hub":r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},r.a.createElement("g",null,r.a.createElement("circle",{opacity:"1",fill:"#777",strokeWidth:"2",stroke:"#fff",r:"8",cy:"10",cx:"10"}))),"potential-supernode":r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28"},r.a.createElement("g",null,r.a.createElement("circle",{opacity:"1",fill:"#777",strokeWidth:"4",stroke:"#fff",r:"10",cy:"14",cx:"14"}))),active:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},r.a.createElement("circle",{cx:"10",cy:"10",r:"8",stroke:"#fff",strokeWidth:"2",fill:"rgb(255,59,48)",opacity:"1"})),hub:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},r.a.createElement("g",null,r.a.createElement("circle",{opacity:"1",fill:"rgb(90,200,250)",strokeWidth:"2",stroke:"#fff",r:"8",cy:"10",cx:"10"}))),supernode:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28"},r.a.createElement("g",null,r.a.createElement("circle",{opacity:"1",fill:"#007aff",strokeWidth:"4",stroke:"#fff",r:"10",cy:"14",cx:"14"}))),linkNYC:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},r.a.createElement("circle",{cx:"10",cy:"10",r:"3",stroke:"white",strokeWidth:"0",fill:"#01a2eb",opacity:"1"}))},N=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.node,n=e.search;return r.a.createElement("div",{className:"h1 overflow-visible flex justify-start items-center"},r.a.createElement("div",{className:"flex items-center justify-center"},C[j(t)]),r.a.createElement("span",{className:"fw6 black f5 mv0 ml1"},r.a.createElement(w.a,{highlightClassName:"bg-light-yellow",searchWords:[n],autoEscape:!0,textToHighlight:String(O(t))})))}}]),t}(a.PureComponent),I=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.node,n=e.search,a=e.onClick,i=t.id;return r.a.createElement(y.a,{className:"link",to:"/nodes/".concat(i)},r.a.createElement("div",{onClick:a,key:i,className:"pointer hover-bg-near-white bb b--light-gray pa3"},r.a.createElement(N,{node:t,search:n})))}}]),t}(a.PureComponent),S=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={filteredNodes:[],search:"",showDropdown:!1},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){t.search===this.state.search&&e.nodes!==this.props.nodes&&this.setState({filteredNodes:this.filterSearch(this.state.search)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"w-100 shadow-2"},this.renderSearchBar(),this.renderList())}},{key:"renderSearchBar",value:function(){var e=this;return r.a.createElement("div",{className:"flex items-center bg-white pv3 overflow-hidden",onClick:function(){e.refs.search.focus()}},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#aaa",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml3 db",style:{minWidth:20}},r.a.createElement("circle",{cx:"11",cy:"11",r:"8"}),r.a.createElement("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})),r.a.createElement("input",{ref:"search",className:"h1 overflow-hidden pl2 pr3 input-reset f5 fw4 bw0 w-100 on",value:this.state.search,placeholder:"Search nodes",spellCheck:!1,autoCorrect:"false",onFocus:function(){return e.setState({showDropdown:!0})},onChange:function(t){return e.setState({search:t.target.value,filteredNodes:e.filterSearch(t.target.value)})}}),this.renderClearButton())}},{key:"renderList",value:function(){var e=this;if(!this.state.filteredNodes.length||!this.state.showDropdown)return null;var t=this.state.search;return r.a.createElement("div",{className:"bg-white bt b--light-gray max-h-5-rows overflow-y-scroll"},this.state.filteredNodes.map(function(n){return r.a.createElement(I,{key:n.id,node:n,search:t,iconColor:e.colorForNode(n),onClick:function(){return e.setState({showDropdown:!1})}})}))}},{key:"renderClearButton",value:function(){var e=this,t=this.state.search;return t&&t.length?r.a.createElement("button",{onClick:function(){e.setState({search:"",filteredNodes:[]})},className:"on btn bn pa0 bg-white pointer mr3 silver"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"db"},r.a.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.a.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):r.a.createElement("div",{className:"mr3",style:{width:20,height:20}})}},{key:"filterSearch",value:function(e){var t=this.props.nodes;return e?Object(k.a)(t.filter(function(t){return t.id===parseInt(e,10)})).concat(Object(k.a)(t.filter(function(t){return[t.name,t.location,t.notes,t.status,t.email].join(" ").toLowerCase().indexOf(e.toLowerCase())>-1}).sort(function(e,t){return e.status!==t.status?"Installed"===e.status?-1:1:e.id-t.id}))):[]}},{key:"colorForNode",value:function(e){var t=e.status,n=e.tickets;return"Installed"===t?"rgb(255,59,48)":n&&n.length>2?"rgb(255,204,0)":"gray"}}]),t}(a.PureComponent),L=Object(f.b)(function(e,t){return{nodes:e.nodes,tickets:e.tickets}},function(e,t){return{}})(S),P=n(20),M=n(23),R=n(374),z=n(1),T=n.n(z),D=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.node,t=this.context.router.history,n=e.id,a=Object(P.a)(e.coordinates,2),i=a[0],o=a[1],s=this.getMarkerProps(),l=s.icon,c=s.zIndex;return r.a.createElement(M.Marker,{defaultPosition:{lat:o,lng:i},icon:l,options:{opacity:this.getOpacity()},zIndex:this.getZIndex(c),onClick:function(){return t.push("/nodes/".concat(n))}})}},{key:"getOpacity",value:function(){var e=this.props.visibility;return"highlight"===e?1:"dim"===e?.25:1}},{key:"getZIndex",value:function(e){return"highlight"===this.props.visibility?999:e}},{key:"getMarkerProps",value:function(){var e=j(this.props.node);return"supernode"===e?{icon:{url:"/img/map/supernode.svg",anchor:{x:14,y:14}},zIndex:100}:"hub"===e?{icon:{url:"/img/map/hub.svg",anchor:{x:10,y:10}},zIndex:99}:"active"===e?{icon:{url:"/img/map/active.svg",anchor:{x:10,y:10}},zIndex:98}:"potential-supernode"===e?{icon:{url:"/img/map/potential-supernode.svg",anchor:{x:14,y:14}},zIndex:89}:"potential-hub"===e?{icon:{url:"/img/map/potential-hub.svg",anchor:{x:10,y:10}},zIndex:88}:"potential"===e?{icon:{url:"/img/map/potential.svg",anchor:{x:8,y:8}},zIndex:87}:{icon:{url:"/img/map/dead.svg",anchor:{x:7,y:7}},zIndex:86}}}]),t}(a.PureComponent);D.contextTypes={router:T.a.object};var F=Object(R.a)(D),K=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={visibility:"default"},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(F,Object.assign({},this.props,{visibility:this.state.visibility}))}},{key:"setVisibility",value:function(e){this.setState({visibility:e})}}]),t}(a.PureComponent),W=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.kiosk,t=Object(P.a)(e.coordinates,2),n=t[0],a=t[1];return r.a.createElement(M.Marker,{defaultPosition:{lat:a,lng:n},icon:{url:"/img/map/kiosk.svg",anchor:{x:5,y:5}},zIndex:1})}}]),t}(a.PureComponent),_=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={visibility:"default"},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.link,t=Object(P.a)(e.coordinates,2),n=t[0],a=t[1],i=Object(P.a)(n,2),o=i[0],s=i[1],l=Object(P.a)(a,2),c=l[0],u={lat:s,lng:o},h={lat:l[1],lng:c},d=this.getLineProps(),f=d.strokeColor,p=d.strokeOpacity,m=d.zIndex;return r.a.createElement(M.Polyline,{path:[u,h],options:{strokeColor:f,strokeOpacity:this.getOpacity(p)},zIndex:this.getZIndex(m)})}},{key:"getOpacity",value:function(e){var t=this.state.visibility;return"highlight"===t?1:"dim"===t?.25*e:e}},{key:"getZIndex",value:function(e){return"highlight"===this.state.visibility?60:e}},{key:"setVisibility",value:function(e){this.setState({visibility:e})}},{key:"getLineProps",value:function(){return"active"===this.props.link.status?{strokeColor:"#007aff",strokeOpacity:1,zIndex:50}:{strokeColor:"#aaa",strokeOpacity:.25,zIndex:50}}}]),t}(a.PureComponent),H=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.lat,n=e.lng,a=e.r,i=e.azimuth,o=e.width,s=e.potential,l={lat:t,lng:n},c=a/3963*(180/Math.PI),u=c/Math.cos(t*(Math.PI/180)),h=[];h.push(l);var d=t+c*Math.cos(Math.PI/180*(i-o/2)),f=n+u*Math.sin(Math.PI/180*(i-o/2));h.push({lat:d,lng:f});for(var p=t+c*Math.cos(Math.PI/180*(i+o/2)),m=n+u*Math.sin(Math.PI/180*(i+o/2)),v=0,b=Math.PI/180*(i+o/2),k=1;v<b;k++){v=Math.PI/180*(i-o/2+k);var y=n+u*Math.sin(v),g=t+c*Math.cos(v);h.push({lat:g,lng:y})}h.push({lat:p,lng:m}),h.push(l);return r.a.createElement(M.Polygon,{path:h,defaultOptions:{strokeColor:"transparent",strokeOpacity:0,strokeWidth:0,fillColor:s?"#777":"#007aff",fillOpacity:.15,clickable:!1}})}}]),t}(a.PureComponent),U=n(160),B=n.n(U),V=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){if(!this.props.match)return null;var e=this.props,t=e.match,n=e.nodes.filter(function(e){return e.id===parseInt(t.params.nodeId,10)});if(!n.length)return null;var a=n[0],i=a.coordinates,o=Object(P.a)(i,2),s=o[0],l=o[1];return r.a.createElement(B.a,{position:new window.google.maps.LatLng(l,s),options:{boxStyle:{overflow:"visible"},boxClass:"overflow-visible pointer-events-none",alignBottom:!0,closeBoxURL:"",enableEventPropagation:!1}},r.a.createElement("div",{style:{marginLeft:"-50%",marginRight:"50%"},className:"mb1 flex flex-column items-center pointer-events-all"},r.a.createElement("div",{className:"flex items-center bg-white br2 overflow-hidden shadow-2"},this.renderImage(a),r.a.createElement("div",{className:"pv1 ph2"},r.a.createElement("span",{className:"f5 fw6 nowrap sans-serif"},O(a)))),r.a.createElement("svg",{viewBox:"0 5 12 12",version:"1.1",width:"12",height:"12","aria-hidden":"true"},r.a.createElement("path",{fillRule:"evenodd",fill:"white",d:"M0 5l6 6 6-6H0z"}))))}},{key:"renderImage",value:function(e){var t=e.id,n=e.panoramas;if(!n||!n.length)return null;var a=Object(P.a)(n,1)[0];return r.a.createElement(y.a,{to:"/nodes/".concat(t,"/panoramas/1"),className:"db node-image"},r.a.createElement("div",{className:"h-100 w-100 cover bg-center bg-near-white",style:{backgroundImage:'url("https://node-db.netlify.com/panoramas/'.concat(a,'")')}}))}}]),t}(a.PureComponent),A=Object(f.b)(function(e,t){return{nodes:e.nodes}},function(e,t){return{}})(V),G={styles:[{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}],fullscreenControl:!1,streetViewControl:!1,zoomControlOptions:{position:"9"},mapTypeControlOptions:{position:"3"},backgroundColor:"#f5f5f5",gestureHandling:"greedy",clickableIcons:!1},Y=Object(M.withScriptjs)(Object(M.withGoogleMap)(function(e){return r.a.createElement(M.GoogleMap,Object.assign({ref:e.mapRef},e),e.children)})),Z=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).map=r.a.createRef(),n.markerRefs={},n.lineRefs={},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.fetchNodes(),this.props.fetchLinks(),this.props.fetchKiosks(),this.keyDownHandler=this.handleKeyDown.bind(this),window.addEventListener("keydown",this.keyDownHandler,!1),this.props.match)try{setTimeout(function(){if(!e.props.match)return null;var t=parseInt(e.props.match.params.nodeId,10),n=e.markerRefs[t];if(n){var a=n.props.node;e.updateNodes(a,n),e.updateLinks(a),e.panToNode(a)}},500)}catch(t){console.error(":(")}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.keyDownHandler,!1)}},{key:"shouldComponentUpdate",value:function(e){return this.props.nodes!==e.node&&(this.handleSelectedChange(e),!0)}},{key:"handleKeyDown",value:function(e){27===e.keyCode&&this.context.router.history.push("/")}},{key:"handleSelectedChange",value:function(e){if(!this.props.match&&!e.match)return!1;if(!e.match)return this.resetAllNodes(),!1;var t=parseInt(e.match.params.nodeId,10),n=this.markerRefs[t];if(n){var a=n.props.node;this.updateNodes(a,n),this.updateLinks(a),this.panToNode(a)}}},{key:"render",value:function(){var e=this.context.router.history;return r.a.createElement(Y,{mapRef:this.map,defaultZoom:13,defaultCenter:{lat:40.7101809,lng:-73.9595798},defaultOptions:G,onClick:function(){return e.push("/")},googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyBNClp7oJsw-eleEoR3-PQKV23tpeW-FpE",loadingElement:r.a.createElement("div",{className:"h-100 bg-map-beige"}),containerElement:r.a.createElement("div",{className:"h-100 bg-map-beige"}),mapElement:r.a.createElement("div",{className:"h-100 bg-map-beige"})},this.renderSectors(),this.renderLinks(),this.renderKiosks(),this.renderNodes(),r.a.createElement(A,{match:this.props.match}))}},{key:"renderNodes",value:function(){var e=this;return this.props.nodes.map(function(t){return r.a.createElement(K,{key:t.id,ref:function(t){e.handleMarkerRef(t)},node:t})})}},{key:"renderKiosks",value:function(){return this.props.kiosks.map(function(e){return r.a.createElement(W,{key:e.id,kiosk:e})})}},{key:"renderLinks",value:function(){var e=this;return this.props.links.map(function(t,n){return r.a.createElement(_,{key:e.linkId(t),ref:function(t){e.handleLineRef(t)},link:t})})}},{key:"renderSectors",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(H,{lat:40.711137,lng:-74.001122,r:2,azimuth:55,width:90}),r.a.createElement(H,{lat:40.713991,lng:-73.929049,r:2,azimuth:180,width:220}),r.a.createElement(H,{lat:40.685823,lng:-73.917272,r:2,azimuth:180,width:360}),r.a.createElement(H,{potential:!0,lat:40.657867,lng:-74.004904,r:2,azimuth:40,width:120}),r.a.createElement(H,{potential:!0,lat:40.657867,lng:-74.004904,r:2,azimuth:160,width:120}))}},{key:"resetAllNodes",value:function(){var e=this;o.a.unstable_batchedUpdates(function(){Object.values(e.markerRefs).forEach(function(e){return e.setVisibility("default")}),Object.values(e.lineRefs).forEach(function(e){return e.setVisibility("default")})})}},{key:"updateNodes",value:function(e,t){var n=this;o.a.unstable_batchedUpdates(function(){Object.values(n.markerRefs).forEach(function(t){"Installed"===e.status?e.id!==t.props.node.id&&t.setVisibility("dim"):"Installed"===t.props.node.status?t.setVisibility("default"):t.setVisibility("dim")}),t.setVisibility("highlight"),e.connectedNodes&&e.connectedNodes.forEach(function(e){var t=n.markerRefs[e];t&&t.setVisibility("highlight")})})}},{key:"updateLinks",value:function(e){var t=this;Object.values(this.lineRefs).forEach(function(e){return e.setVisibility("dim")}),e.links&&e.links.forEach(function(e){var n=t.lineRefs[t.linkId(e)];n&&n.setVisibility("highlight")})}},{key:"panToNode",value:function(e){var t=Object(P.a)(e.coordinates,2),n=t[0],a=t[1];this.map.current.panTo({lat:a,lng:n})}},{key:"handleMarkerRef",value:function(e){e&&(this.markerRefs[e.props.node.id]=e)}},{key:"handleLineRef",value:function(e){e&&(this.lineRefs[this.linkId(e.props.link)]=e)}},{key:"linkId",value:function(e){return"".concat(e.from,"-").concat(e.to," ").concat(e.coordinates," ").concat(e.status)}}]),t}(a.Component);Z.contextTypes={router:T.a.object};var J=Object(R.a)(Z);var Q=Object(f.b)(function(e,t){return{nodes:e.filteredNodes,links:e.filteredLinks,kiosks:e.kiosks,tickets:e.tickets}},function(e,t){return{fetchNodes:function(){return function(e){fetch("https://node-db.netlify.com/nodes.json").then(function(e){return e.json()}).then(function(t){e({type:"FETCH_NODES_SUCCESS",nodes:t})}).catch(function(e){return console.log(e)})}(e)},fetchLinks:function(){return function(e){fetch("https://node-db.netlify.com/links.json").then(function(e){return e.json()}).then(function(t){e({type:"FETCH_LINKS_SUCCESS",links:t})}).catch(function(e){return console.log(e)})}(e)},fetchKiosks:function(){return function(e){fetch("https://node-db.netlify.com/kiosks.json").then(function(e){return e.json()}).then(function(t){e({type:"FETCH_KIOSKS_SUCCESS",kiosks:t})}).catch(function(e){return console.log(e)})}(e)}}})(J),q=["active","potential","supernode","hub","linkNYC"],X=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"bg-white shadow-2"},r.a.createElement("div",{role:"group",className:"dib pa2"},r.a.createElement("div",null,q.map(function(t){return e.renderFilter(t)}))))}},{key:"renderFilter",value:function(e){var t=this.props,n=t.filters,a=t.statusCounts,i=t.toggleFilter,o=n[e]||void 0===n[e]?"o-100":"o-50 strike";return r.a.createElement("div",{key:e,className:"pointer ".concat(o)},r.a.createElement("input",{className:"ma0 mr1 dn",type:"checkbox",id:e,name:"feature",value:e,defaultChecked:!0}),r.a.createElement("label",{htmlFor:e,style:{color:x[e]},className:"ttc pointer flex items-center nowrap",onClick:function(){return i(e)}},r.a.createElement("div",{style:{marginLeft:"-0.5rem",marginRight:"-0.25rem",marginTop:"-0.125rem",marginBottom:"-0.125rem"},className:"h2 w2 flex items-center justify-center"},C[e]),r.a.createElement("span",{className:"ml1"},e.replace("-"," ")," (",a[e]||0,")")))}}]),t}(a.PureComponent),$=Object(f.b)(function(e,t){return{filters:e.filters,statusCounts:e.statusCounts}},function(e,t){return{toggleFilter:function(t){return function(e,t){t({type:"TOGGLE_FILTER",label:e})}(t,e)}}})(X),ee=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.keyDownHandler=this.handleKeyDown.bind(this),window.addEventListener("keydown",this.keyDownHandler,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.keyDownHandler,!1)}},{key:"handleKeyDown",value:function(e){if(27===e.keyCode){var t=this.props.match.params.nodeId;this.context.router.history.push("/nodes/".concat(t))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.match,a=t.nodes,i=n.params,o=i.nodeId,s=i.panoId,l=a.filter(function(e){return e.id===parseInt(o,10)});if(!l||!l.length)return null;var c=l[0].panoramas;if(!c||!c.length)return null;var u=c[s-1];return r.a.createElement(m.a,{title:"Panorama ".concat(s," - Node ").concat(o," - NYC Mesh")},r.a.createElement("div",{onKeyDown:function(t){return e.onKeyPressed(t)},className:"fixed absolute--fill bg-black flex items-center justify-center z-max"},r.a.createElement(y.a,{to:"..",className:"absolute top-0 left-0 ma3 white"},r.a.createElement("svg",{className:"db ma0",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.a.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))),r.a.createElement("img",{onClick:function(){return window.open("https://node-db.netlify.com/panoramas/".concat(u),"_blank").focus()},className:"db center mh-100 mw-100 zoom-in",src:"https://node-db.netlify.com/panoramas/".concat(u),alt:"Panorama"})))}},{key:"onKeyPressed",value:function(e){}}]),t}(a.PureComponent);ee.contextTypes={router:T.a.object};var te=Object(f.b)(function(e,t){return{nodes:e.nodes}},function(e,t){return{}})(ee),ne=n(71),ae=n(36),re={nodes:[],links:[],kiosks:[],filteredNodes:[],filteredLinks:[],filters:{},statusCounts:{}};function ie(e,t){return e.filter(function(e){return void 0===t[j(e)]||t[j(e)]})}function oe(e,t){return e.filter(function(e){return!e.fromNode||!e.toNode||(void 0===t[j(e.fromNode)]||!1!==t[j(e.fromNode)])&&(void 0===t[j(e.toNode)]||!1!==t[j(e.toNode)])})}function se(e,t){e.filter(function(e){return"Installed"===e.status}).forEach(function(e){var n=[e.id];t.forEach(function(t){"active"===t.status&&(t.from===parseInt(e.id,10)&&n.push(t.to),t.to===parseInt(e.id,10)&&n.push(t.from))}),e.connectedNodes=n});var n={};return e.forEach(function(e){e.links=t.filter(function(t){return"active"===t.status&&(t.from===parseInt(e.id,10)||t.to===parseInt(e.id,10))}),n[e.id]=e}),t.forEach(function(e){e.fromNode=n[e.from],e.toNode=n[e.to]}),{nodes:e,links:t}}var le=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"TOGGLE_FILTER":var r=Object(ae.a)({},n.filters,Object(ne.a)({},a.label,void 0!==n.filters[a.label]&&!n.filters[a.label]));return"potential"===a.label&&(r.dead=void 0!==n.filters.dead&&!n.filters.dead,r["potential-hub"]=void 0!==n.filters["potential-hub"]&&!n.filters["potential-hub"],r["potential-supernode"]=void 0!==n.filters["potential-supernode"]&&!n.filters["potential-supernode"]),Object(ae.a)({},n,{filters:r,filteredNodes:ie(n.nodes,r),filteredLinks:oe(n.links,r)});case"FETCH_NODES_SUCCESS":var i=se(a.nodes,n.links).nodes,o=(e=a.nodes,t={},e.forEach(function(e){var n=j(e);t[n]=(t[n]||0)+1,(n.indexOf("potential-")>-1||"dead"===n)&&(t.potential=(t.potential||0)+1),"supernode"!==n&&"hub"!==n||(t.active=(t.active||0)+1)}),t);return Object(ae.a)({},n,{nodes:i,filteredNodes:ie(i,n.filters),statusCounts:o});case"FETCH_LINKS_SUCCESS":var s=se(n.nodes,a.links).links;return Object(ae.a)({},n,{links:s,filteredLinks:oe(s,n.filters)});case"FETCH_KIOSKS_SUCCESS":return Object(ae.a)({},n,{kiosks:a.kiosks,statusCounts:Object(ae.a)({},n.statusCounts,{linkNYC:a.kiosks.length})});default:return n}},ce=Object(d.b)(le),ue=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,{title:"Map - NYC Mesh"},r.a.createElement(f.a,{store:ce},r.a.createElement(v.a,{basename:"/map"},r.a.createElement("div",{className:"h-100 sans-serif"},r.a.createElement("div",{className:"h-100 w-100 relative"},r.a.createElement("div",{className:"absolute pa2 z-999 search-bar"},r.a.createElement(L,null)),r.a.createElement(b.a,{path:"/nodes/:nodeId",children:function(e){var t=e.match;return r.a.createElement(Q,{match:t})}}),r.a.createElement("div",{className:"absolute bottom-0 left-0 ma2"},r.a.createElement($,null))),r.a.createElement(b.a,{path:"/nodes/:nodeId/panoramas/:panoId",component:te})))))}},{key:"handleNodeClick",value:function(e){}}]),t}(a.Component);o.a.render(r.a.createElement(ue,null),document.getElementById("map-root"))}},[[163,2,1]]]);
//# sourceMappingURL=main.712e05dc.chunk.js.map