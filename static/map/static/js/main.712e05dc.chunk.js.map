{"version":3,"sources":["utils/index.js","components/NodeName.js","components/SearchBar/NodeRow.js","components/SearchBar/component.js","components/SearchBar/connected.js","components/MapView/NodeMarker.js","components/MapView/KioskMarker.js","components/MapView/LinkLine.js","components/MapView/Sector.js","components/NodeDetail/component.js","components/NodeDetail/connected.js","components/MapView/component.js","components/MapView/styles.js","components/MapView/connected.js","actions/index.js","components/Filters/component.js","components/Filters/connected.js","components/Gallery/component.js","components/Gallery/connected.js","reducers/index.js","App.js","index.js"],"names":["nodeNames","227","570","713","nodeName","node","id","concat","nodeStatus","status","notes","panoramas","isActive","isSupernode","toLowerCase","indexOf","isHub","hasPanoramas","length","nodeColors","active","dead","hub","kiosk","linkNYC","potential-hub","potential-supernode","potential","supernode","icons","react_default","a","createElement","xmlns","width","height","cx","cy","r","stroke","strokeWidth","fill","opacity","NodeName","_this$props","this","props","search","className","main_default","highlightClassName","searchWords","autoEscape","textToHighlight","String","PureComponent","NodeRow","onClick","Link","to","key","NodeName_NodeName","SearchBar","state","filteredNodes","showDropdown","prevProps","prevState","nodes","setState","filterSearch","renderSearchBar","renderList","_this2","refs","focus","viewBox","strokeLinecap","strokeLinejoin","style","minWidth","x1","y1","x2","y2","ref","value","placeholder","spellCheck","autoCorrect","onFocus","onChange","event","target","renderClearButton","_this3","map","NodeRow_NodeRow","iconColor","colorForNode","_this4","Object","toConsumableArray","filter","parseInt","name","location","email","join","sort","b","tickets","connect","ownProps","dispatch","PureSearchBar","NodeMarker","history","context","router","_node$coordinates","slicedToArray","coordinates","lng","lat","_this$getMarkerProps","getMarkerProps","icon","zIndex","lib","defaultPosition","options","getOpacity","getZIndex","push","visibility","defaultZIndex","url","anchor","x","y","contextTypes","PropTypes","object","RouterNodeMarker","withRouter","CombinedMarker","assign","KioskMarker","_kiosk$coordinates","LinkLine","link","_link$coordinates","start","end","_start","lng1","lat1","_end","lng2","latlng1","latlng2","_this$getLineProps","getLineProps","strokeColor","strokeOpacity","path","defaultOpacity","azimuth","centerPoint","PRlat","Math","PI","PRlng","cos","PGpoints","lon1","sin","lat2","lon2","theta","gamma","PGlon","PGlat","defaultOptions","fillColor","fillOpacity","clickable","NodeDetail","match","matchingNodes","params","nodeId","_coordinates","InfoBox_default","position","window","google","maps","LatLng","boxStyle","overflow","boxClass","alignBottom","closeBoxURL","enableEventPropagation","marginLeft","marginRight","renderImage","version","aria-hidden","fillRule","d","firstPanorama","backgroundImage","styles","elementType","stylers","featureType","fullscreenControl","streetViewControl","zoomControlOptions","mapTypeControlOptions","backgroundColor","gestureHandling","clickableIcons","MapComponent","withScriptjs","withGoogleMap","mapRef","children","MapView","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","React","createRef","markerRefs","lineRefs","fetchNodes","fetchLinks","fetchKiosks","keyDownHandler","handleKeyDown","bind","addEventListener","setTimeout","selectedNodeId","selectedMarker","selectedNode","updateNodes","updateLinks","panToNode","e","console","error","removeEventListener","nextProps","handleSelectedChange","keyCode","resetAllNodes","nextSelectedNodeId","nextSelectedMarker","nextSelectedNode","defaultZoom","defaultCenter","googleMapURL","loadingElement","containerElement","mapElement","renderSectors","renderLinks","renderKiosks","renderNodes","NodeDetail_connected","NodeMarker_CombinedMarker","handleMarkerRef","kiosks","KioskMarker_KioskMarker","links","index","LinkLine_LinkLine","linkId","handleLineRef","react","Sector_LinkLine","_this5","ReactDOM","unstable_batchedUpdates","values","forEach","marker","setVisibility","line","_this6","connectedNodes","connectedNodeId","connectedMarker","_this7","current","panTo","from","Component","filteredLinks","fetch","then","res","json","type","catch","err","log","PureMapView","labels","Filters","role","label","renderFilter","filters","statusCounts","toggleFilter","undefined","defaultChecked","htmlFor","color","marginTop","marginBottom","replace","PureFilters","Gallery","_match$params","panoId","src","react_document_title_default","title","onKeyDown","onKeyPressed","open","alt","PureGallery","initialState","filterNodes","filterLinks","fromNode","toNode","addGraphData","nodeMap","reducer","counts","arguments","action","newFilters","objectSpread","defineProperty","newNodes","newStatusCounts","newLinks","store","createStore","rootReducer","App","es","BrowserRouter","basename","connected","Route","_ref","MapView_connected","Filters_connected","component","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.712e05dc.chunk.js","sourcesContent":["// Temporary hack\nconst nodeNames = {\n\t227: \"Supernode 1\",\n\t570: \"Supernode 2\",\n\t713: \"Supernode 3\"\n};\n\nexport function nodeName(node) {\n\treturn nodeNames[node.id] || `Node ${node.id}`;\n}\n\nexport function nodeStatus(node) {\n\tconst { status, notes, panoramas } = node;\n\tconst isActive = status === \"Installed\";\n\tconst isSupernode = notes && notes.toLowerCase().indexOf(\"supernode\") > -1;\n\tconst isHub = notes && notes.toLowerCase().indexOf(\"hub\") > -1;\n\tconst hasPanoramas = panoramas && panoramas.length;\n\n\tif (isActive) {\n\t\tif (isSupernode) return \"supernode\";\n\t\tif (isHub) return \"hub\";\n\t\treturn \"active\";\n\t}\n\n\tif (isSupernode) return \"potential-supernode\";\n\tif (isHub) return \"potential-hub\";\n\tif (hasPanoramas) return \"potential\";\n\treturn \"dead\";\n}\n\nexport const nodeColors = {\n\tactive: \"rgb(255,59,48)\",\n\tdead: \"#aaa\",\n\thub: \"rgb(90,200,250)\",\n\tkiosk: \"#01a2eb\",\n\tlinkNYC: \"#01a2eb\",\n\t\"potential-hub\": \"#777\",\n\t\"potential-supernode\": \"#777\",\n\tpotential: \"#777\",\n\tsupernode: \"#007aff\"\n};\n","import React, { PureComponent } from \"react\";\nimport Highlighter from \"react-highlight-words\";\n\nimport { nodeStatus, nodeName } from \"../utils\";\n\nexport const icons = {\n\tdead: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\">\n\t\t\t<circle\n\t\t\t\tcx=\"7\"\n\t\t\t\tcy=\"7\"\n\t\t\t\tr=\"5\"\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\tfill=\"#aaa\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t),\n\tpotential: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\">\n\t\t\t<circle\n\t\t\t\tcx=\"8\"\n\t\t\t\tcy=\"8\"\n\t\t\t\tr=\"6\"\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\tfill=\"#777\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t),\n\t\"potential-hub\": (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"#777\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"8\"\n\t\t\t\t\tcy=\"10\"\n\t\t\t\t\tcx=\"10\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\t\"potential-supernode\": (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"#777\"\n\t\t\t\t\tstrokeWidth=\"4\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"10\"\n\t\t\t\t\tcy=\"14\"\n\t\t\t\t\tcx=\"14\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\tactive: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<circle\n\t\t\t\tcx=\"10\"\n\t\t\t\tcy=\"10\"\n\t\t\t\tr=\"8\"\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\tfill=\"rgb(255,59,48)\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t),\n\thub: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"rgb(90,200,250)\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"8\"\n\t\t\t\t\tcy=\"10\"\n\t\t\t\t\tcx=\"10\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\tsupernode: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\n\t\t\t<g>\n\t\t\t\t<circle\n\t\t\t\t\topacity=\"1\"\n\t\t\t\t\tfill=\"#007aff\"\n\t\t\t\t\tstrokeWidth=\"4\"\n\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\tr=\"10\"\n\t\t\t\t\tcy=\"14\"\n\t\t\t\t\tcx=\"14\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t),\n\tlinkNYC: (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\">\n\t\t\t<circle\n\t\t\t\tcx=\"10\"\n\t\t\t\tcy=\"10\"\n\t\t\t\tr=\"3\"\n\t\t\t\tstroke=\"white\"\n\t\t\t\tstrokeWidth=\"0\"\n\t\t\t\tfill=\"#01a2eb\"\n\t\t\t\topacity=\"1\"\n\t\t\t/>\n\t\t</svg>\n\t)\n};\n\nexport default class NodeName extends PureComponent {\n\trender() {\n\t\tconst { node, search } = this.props;\n\t\treturn (\n\t\t\t<div className=\"h1 overflow-visible flex justify-start items-center\">\n\t\t\t\t<div className=\"flex items-center justify-center\">\n\t\t\t\t\t{icons[nodeStatus(node)]}\n\t\t\t\t</div>\n\t\t\t\t<span className=\"fw6 black f5 mv0 ml1\">\n\t\t\t\t\t<Highlighter\n\t\t\t\t\t\thighlightClassName=\"bg-light-yellow\"\n\t\t\t\t\t\tsearchWords={[search]}\n\t\t\t\t\t\tautoEscape={true}\n\t\t\t\t\t\ttextToHighlight={String(nodeName(node))}\n\t\t\t\t\t/>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport NodeName from \"../NodeName\";\n\nexport default class NodeRow extends PureComponent {\n\trender() {\n\t\tconst { node, search, onClick } = this.props;\n\t\tconst { id } = node;\n\t\treturn (\n\t\t\t<Link className=\"link\" to={`/nodes/${id}`}>\n\t\t\t\t<div\n\t\t\t\t\tonClick={onClick}\n\t\t\t\t\tkey={id}\n\t\t\t\t\tclassName=\"pointer hover-bg-near-white bb b--light-gray pa3\"\n\t\t\t\t>\n\t\t\t\t\t<NodeName node={node} search={search} />\n\t\t\t\t</div>\n\t\t\t</Link>\n\t\t);\n\t}\n}\n","import React, { PureComponent } from \"react\";\n\nimport NodeRow from \"./NodeRow\";\n\nexport default class SearchBar extends PureComponent {\n\tstate = {\n\t\tfilteredNodes: [],\n\t\tsearch: \"\",\n\t\tshowDropdown: false\n\t};\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\t// Super hacky, do this better\n\t\tif (\n\t\t\tprevState.search === this.state.search &&\n\t\t\tprevProps.nodes !== this.props.nodes\n\t\t) {\n\t\t\tthis.setState({\n\t\t\t\tfilteredNodes: this.filterSearch(this.state.search)\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"w-100 shadow-2\">\n\t\t\t\t{this.renderSearchBar()}\n\t\t\t\t{this.renderList()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderSearchBar() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"flex items-center bg-white pv3 overflow-hidden\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\tthis.refs.search.focus();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"#aaa\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\tclassName=\"ml3 db\"\n\t\t\t\t\tstyle={{ minWidth: 20 }}\n\t\t\t\t>\n\t\t\t\t\t<circle cx=\"11\" cy=\"11\" r=\"8\" />\n\t\t\t\t\t<line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n\t\t\t\t</svg>\n\t\t\t\t<input\n\t\t\t\t\tref=\"search\"\n\t\t\t\t\tclassName=\"h1 overflow-hidden pl2 pr3 input-reset f5 fw4 bw0 w-100 on\"\n\t\t\t\t\tvalue={this.state.search}\n\t\t\t\t\tplaceholder=\"Search nodes\"\n\t\t\t\t\tspellCheck={false}\n\t\t\t\t\tautoCorrect=\"false\"\n\t\t\t\t\tonFocus={() => this.setState({ showDropdown: true })}\n\t\t\t\t\tonChange={event =>\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tsearch: event.target.value,\n\t\t\t\t\t\t\tfilteredNodes: this.filterSearch(event.target.value)\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t{this.renderClearButton()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderList() {\n\t\tif (!this.state.filteredNodes.length || !this.state.showDropdown) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { search } = this.state;\n\t\treturn (\n\t\t\t<div className=\"bg-white bt b--light-gray max-h-5-rows overflow-y-scroll\">\n\t\t\t\t{this.state.filteredNodes.map(node => (\n\t\t\t\t\t<NodeRow\n\t\t\t\t\t\tkey={node.id}\n\t\t\t\t\t\tnode={node}\n\t\t\t\t\t\tsearch={search}\n\t\t\t\t\t\ticonColor={this.colorForNode(node)}\n\t\t\t\t\t\tonClick={() => this.setState({ showDropdown: false })}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderClearButton() {\n\t\tconst { search } = this.state;\n\n\t\tif (!search || !search.length) {\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"mr3\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\twidth: 20,\n\t\t\t\t\t\theight: 20\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<button\n\t\t\t\tonClick={() => {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tsearch: \"\",\n\t\t\t\t\t\tfilteredNodes: []\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t\tclassName=\"on btn bn pa0 bg-white pointer mr3 silver\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\twidth=\"20\"\n\t\t\t\t\theight=\"20\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\tclassName=\"db\"\n\t\t\t\t>\n\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t);\n\t}\n\n\tfilterSearch(search) {\n\t\tconst { nodes } = this.props;\n\t\tif (!search) {\n\t\t\treturn [];\n\t\t}\n\t\treturn [\n\t\t\t...nodes.filter(node => node.id === parseInt(search, 10)),\n\t\t\t...nodes\n\t\t\t\t.filter(\n\t\t\t\t\tnode =>\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tnode.name,\n\t\t\t\t\t\t\tnode.location,\n\t\t\t\t\t\t\tnode.notes,\n\t\t\t\t\t\t\tnode.status,\n\t\t\t\t\t\t\tnode.email\n\t\t\t\t\t\t]\n\t\t\t\t\t\t\t.join(\" \")\n\t\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t\t.indexOf(search.toLowerCase()) > -1\n\t\t\t\t)\n\t\t\t\t.sort((a, b) => {\n\t\t\t\t\tif (a.status !== b.status) {\n\t\t\t\t\t\tif (a.status === \"Installed\") return -1;\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.id - b.id;\n\t\t\t\t})\n\t\t];\n\t}\n\n\tcolorForNode(node) {\n\t\tconst { status, tickets } = node;\n\t\treturn status === \"Installed\"\n\t\t\t? \"rgb(255,59,48)\"\n\t\t\t: tickets && tickets.length > 2\n\t\t\t\t? \"rgb(255,204,0)\"\n\t\t\t\t: \"gray\";\n\t}\n}\n","import { connect } from \"react-redux\";\nimport PureSearchBar from \"./component\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.nodes,\n\ttickets: state.tickets\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureSearchBar);\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Marker } from \"react-google-maps\";\nimport { withRouter } from \"react-router\";\n\nimport { nodeStatus } from \"../../utils\";\n\nclass NodeMarker extends PureComponent {\n\tstatic contextTypes = {\n\t\trouter: PropTypes.object\n\t};\n\n\trender() {\n\t\tconst { node } = this.props;\n\t\tconst { history } = this.context.router;\n\t\tconst { id } = node;\n\t\tconst [lng, lat] = node.coordinates;\n\t\tconst { icon, zIndex } = this.getMarkerProps();\n\n\t\treturn (\n\t\t\t<Marker\n\t\t\t\tdefaultPosition={{ lat, lng }}\n\t\t\t\ticon={icon}\n\t\t\t\toptions={{ opacity: this.getOpacity() }}\n\t\t\t\tzIndex={this.getZIndex(zIndex)}\n\t\t\t\tonClick={() => history.push(`/nodes/${id}`)}\n\t\t\t/>\n\t\t);\n\t}\n\n\tgetOpacity() {\n\t\tconst { visibility } = this.props;\n\t\tif (visibility === \"highlight\") return 1;\n\t\tif (visibility === \"dim\") return 0.25;\n\t\treturn 1;\n\t}\n\n\tgetZIndex(defaultZIndex) {\n\t\tconst { visibility } = this.props;\n\t\tif (visibility === \"highlight\") return 999;\n\t\treturn defaultZIndex;\n\t}\n\n\tgetMarkerProps() {\n\t\tconst { node } = this.props;\n\n\t\tconst status = nodeStatus(node);\n\n\t\tif (status === \"supernode\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/supernode.svg\",\n\t\t\t\t\tanchor: { x: 14, y: 14 }\n\t\t\t\t},\n\t\t\t\tzIndex: 100\n\t\t\t};\n\n\t\tif (status === \"hub\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/hub.svg\",\n\t\t\t\t\tanchor: { x: 10, y: 10 }\n\t\t\t\t},\n\t\t\t\tzIndex: 99\n\t\t\t};\n\n\t\tif (status === \"active\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/active.svg\",\n\t\t\t\t\tanchor: { x: 10, y: 10 }\n\t\t\t\t},\n\t\t\t\tzIndex: 98\n\t\t\t};\n\n\t\tif (status === \"potential-supernode\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/potential-supernode.svg\",\n\t\t\t\t\tanchor: { x: 14, y: 14 }\n\t\t\t\t},\n\t\t\t\tzIndex: 89\n\t\t\t};\n\n\t\tif (status === \"potential-hub\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/potential-hub.svg\",\n\t\t\t\t\tanchor: { x: 10, y: 10 }\n\t\t\t\t},\n\t\t\t\tzIndex: 88\n\t\t\t};\n\n\t\tif (status === \"potential\")\n\t\t\treturn {\n\t\t\t\ticon: {\n\t\t\t\t\turl: \"/img/map/potential.svg\",\n\t\t\t\t\tanchor: { x: 8, y: 8 }\n\t\t\t\t},\n\t\t\t\tzIndex: 87\n\t\t\t};\n\n\t\treturn {\n\t\t\ticon: {\n\t\t\t\turl: \"/img/map/dead.svg\",\n\t\t\t\tanchor: { x: 7, y: 7 }\n\t\t\t},\n\t\t\tzIndex: 86\n\t\t};\n\t}\n}\n\nconst RouterNodeMarker = withRouter(NodeMarker);\n\nexport default class CombinedMarker extends PureComponent {\n\tstate = {\n\t\tvisibility: \"default\"\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<RouterNodeMarker\n\t\t\t\t{...this.props}\n\t\t\t\tvisibility={this.state.visibility}\n\t\t\t/>\n\t\t);\n\t}\n\n\tsetVisibility(visibility) {\n\t\tthis.setState({ visibility });\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Marker } from \"react-google-maps\";\n\nexport default class KioskMarker extends PureComponent {\n\trender() {\n\t\tconst { kiosk } = this.props;\n\t\tconst [lng, lat] = kiosk.coordinates;\n\t\tconst icon = {\n\t\t\turl: \"/img/map/kiosk.svg\",\n\t\t\tanchor: { x: 5, y: 5 }\n\t\t};\n\t\treturn <Marker defaultPosition={{ lat, lng }} icon={icon} zIndex={1} />;\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Polyline } from \"react-google-maps\";\n\nexport default class LinkLine extends PureComponent {\n\tstate = {\n\t\tvisibility: \"default\"\n\t};\n\n\trender() {\n\t\tconst { link } = this.props;\n\n\t\tconst [start, end] = link.coordinates;\n\t\tconst [lng1, lat1] = start;\n\t\tconst [lng2, lat2] = end;\n\t\tconst latlng1 = { lat: lat1, lng: lng1 };\n\t\tconst latlng2 = { lat: lat2, lng: lng2 };\n\n\t\tconst { strokeColor, strokeOpacity, zIndex } = this.getLineProps();\n\n\t\treturn (\n\t\t\t<Polyline\n\t\t\t\tpath={[latlng1, latlng2]}\n\t\t\t\toptions={{\n\t\t\t\t\tstrokeColor,\n\t\t\t\t\tstrokeOpacity: this.getOpacity(strokeOpacity)\n\t\t\t\t}}\n\t\t\t\tzIndex={this.getZIndex(zIndex)}\n\t\t\t/>\n\t\t);\n\t}\n\n\tgetOpacity(defaultOpacity) {\n\t\tconst { visibility } = this.state;\n\t\tif (visibility === \"highlight\") return 1;\n\t\tif (visibility === \"dim\") return defaultOpacity * 0.25;\n\t\treturn defaultOpacity;\n\t}\n\n\tgetZIndex(defaultZIndex) {\n\t\tconst { visibility } = this.state;\n\t\tif (visibility === \"highlight\") return 60;\n\t\treturn defaultZIndex;\n\t}\n\n\tsetVisibility(visibility) {\n\t\tthis.setState({ visibility });\n\t}\n\n\tgetLineProps() {\n\t\tconst { link } = this.props;\n\t\tconst { status } = link;\n\n\t\tif (status === \"active\")\n\t\t\treturn {\n\t\t\t\tstrokeColor: \"#007aff\",\n\t\t\t\tstrokeOpacity: 1,\n\t\t\t\tzIndex: 50\n\t\t\t};\n\n\t\treturn {\n\t\t\tstrokeColor: \"#aaa\",\n\t\t\tstrokeOpacity: 0.25,\n\t\t\tzIndex: 50\n\t\t};\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport { Polygon } from \"react-google-maps\";\n\nexport default class LinkLine extends PureComponent {\n\trender() {\n\t\tconst { lat, lng, r, azimuth, width, potential } = this.props;\n\t\tvar centerPoint = { lat, lng };\n\t\tvar PRlat = (r / 3963) * (180 / Math.PI); // using 3963 miles as earth's radius\n\t\tvar PRlng = PRlat / Math.cos(lat * (Math.PI / 180));\n\t\tvar PGpoints = [];\n\t\tPGpoints.push(centerPoint);\n\n\t\tconst lat1 =\n\t\t\tlat + PRlat * Math.cos((Math.PI / 180) * (azimuth - width / 2));\n\t\tconst lon1 =\n\t\t\tlng + PRlng * Math.sin((Math.PI / 180) * (azimuth - width / 2));\n\t\tPGpoints.push({ lat: lat1, lng: lon1 });\n\n\t\tconst lat2 =\n\t\t\tlat + PRlat * Math.cos((Math.PI / 180) * (azimuth + width / 2));\n\t\tconst lon2 =\n\t\t\tlng + PRlng * Math.sin((Math.PI / 180) * (azimuth + width / 2));\n\n\t\tvar theta = 0;\n\t\tvar gamma = (Math.PI / 180) * (azimuth + width / 2);\n\n\t\tfor (var a = 1; theta < gamma; a++) {\n\t\t\ttheta = (Math.PI / 180) * (azimuth - width / 2 + a);\n\t\t\tconst PGlon = lng + PRlng * Math.sin(theta);\n\t\t\tconst PGlat = lat + PRlat * Math.cos(theta);\n\n\t\t\tPGpoints.push({ lat: PGlat, lng: PGlon });\n\t\t}\n\n\t\tPGpoints.push({ lat: lat2, lng: lon2 });\n\t\tPGpoints.push(centerPoint);\n\n\t\tconst fillOpacity = 0.15;\n\n\t\treturn (\n\t\t\t<Polygon\n\t\t\t\tpath={PGpoints}\n\t\t\t\tdefaultOptions={{\n\t\t\t\t\tstrokeColor: \"transparent\",\n\t\t\t\t\tstrokeOpacity: 0,\n\t\t\t\t\tstrokeWidth: 0,\n\t\t\t\t\tfillColor: potential ? \"#777\" : \"#007aff\",\n\t\t\t\t\tfillOpacity,\n\t\t\t\t\tclickable: false\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t}\n}\n","import React, { PureComponent } from \"react\";\nimport InfoBox from \"react-google-maps/lib/components/addons/InfoBox\";\nimport { Link } from \"react-router-dom\";\n\nimport { nodeName } from \"../../utils\";\n\nexport default class NodeDetail extends PureComponent {\n\trender() {\n\t\tif (!this.props.match) return null;\n\n\t\tconst { match, nodes } = this.props;\n\n\t\tconst matchingNodes = nodes.filter(\n\t\t\tnode => node.id === parseInt(match.params.nodeId, 10)\n\t\t);\n\n\t\tif (!matchingNodes.length) return null;\n\n\t\tconst node = matchingNodes[0];\n\t\tconst { coordinates } = node;\n\t\tconst [lng, lat] = coordinates;\n\n\t\treturn (\n\t\t\t<InfoBox\n\t\t\t\tposition={new window.google.maps.LatLng(lat, lng)}\n\t\t\t\toptions={{\n\t\t\t\t\tboxStyle: { overflow: \"visible\" },\n\t\t\t\t\tboxClass: \"overflow-visible pointer-events-none\",\n\t\t\t\t\talignBottom: true,\n\t\t\t\t\tcloseBoxURL: ``,\n\t\t\t\t\tenableEventPropagation: false\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmarginLeft: \"-50%\",\n\t\t\t\t\t\tmarginRight: \"50%\"\n\t\t\t\t\t}}\n\t\t\t\t\tclassName=\"mb1 flex flex-column items-center pointer-events-all\"\n\t\t\t\t>\n\t\t\t\t\t<div className=\"flex items-center bg-white br2 overflow-hidden shadow-2\">\n\t\t\t\t\t\t{this.renderImage(node)}\n\t\t\t\t\t\t<div className=\"pv1 ph2\">\n\t\t\t\t\t\t\t<span className=\"f5 fw6 nowrap sans-serif\">\n\t\t\t\t\t\t\t\t{nodeName(node)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<svg\n\t\t\t\t\t\tviewBox=\"0 5 12 12\"\n\t\t\t\t\t\tversion=\"1.1\"\n\t\t\t\t\t\twidth=\"12\"\n\t\t\t\t\t\theight=\"12\"\n\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\t\t\t\tfill=\"white\"\n\t\t\t\t\t\t\td=\"M0 5l6 6 6-6H0z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</InfoBox>\n\t\t);\n\t}\n\n\trenderImage(node) {\n\t\tconst { id, panoramas } = node;\n\t\tif (!panoramas || !panoramas.length) {\n\t\t\treturn null;\n\t\t}\n\t\tconst [firstPanorama] = panoramas;\n\t\treturn (\n\t\t\t<Link to={`/nodes/${id}/panoramas/1`} className=\"db node-image\">\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"h-100 w-100 cover bg-center bg-near-white\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tbackgroundImage: `url(\"https://node-db.netlify.com/panoramas/${firstPanorama}\")`\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</Link>\n\t\t);\n\t}\n}\n","import { connect } from \"react-redux\";\nimport PureComponent from \"./component\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.nodes\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureComponent);\n","import React, { Component, Fragment } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { withScriptjs, withGoogleMap, GoogleMap } from \"react-google-maps\";\nimport { withRouter } from \"react-router\";\nimport PropTypes from \"prop-types\";\n\nimport NodeMarker from \"./NodeMarker\";\nimport KioskMarker from \"./KioskMarker\";\nimport LinkLine from \"./LinkLine\";\nimport Sector from \"./Sector\";\nimport NodeDetail from \"../NodeDetail\";\n\nimport { mapStyles } from \"./styles\";\n\nconst options = {\n\tstyles: mapStyles,\n\tfullscreenControl: false,\n\tstreetViewControl: false,\n\tzoomControlOptions: {\n\t\tposition: \"9\"\n\t},\n\tmapTypeControlOptions: {\n\t\tposition: \"3\"\n\t},\n\tbackgroundColor: \"#f5f5f5\",\n\tgestureHandling: \"greedy\",\n\tclickableIcons: false\n};\n\nconst MapComponent = withScriptjs(\n\twithGoogleMap(props => (\n\t\t<GoogleMap ref={props.mapRef} {...props}>\n\t\t\t{props.children}\n\t\t</GoogleMap>\n\t))\n);\n\nclass MapView extends Component {\n\tstatic contextTypes = {\n\t\trouter: PropTypes.object\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.map = React.createRef();\n\t\tthis.markerRefs = {};\n\t\tthis.lineRefs = {};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.fetchNodes();\n\t\tthis.props.fetchLinks();\n\t\tthis.props.fetchKiosks();\n\n\t\tthis.keyDownHandler = this.handleKeyDown.bind(this);\n\t\twindow.addEventListener(\"keydown\", this.keyDownHandler, false);\n\n\t\tif (this.props.match) {\n\t\t\ttry {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (!this.props.match) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst selectedNodeId = parseInt(\n\t\t\t\t\t\tthis.props.match.params.nodeId,\n\t\t\t\t\t\t10\n\t\t\t\t\t);\n\t\t\t\t\tconst selectedMarker = this.markerRefs[selectedNodeId];\n\t\t\t\t\tif (!selectedMarker) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { node: selectedNode } = selectedMarker.props;\n\t\t\t\t\tthis.updateNodes(selectedNode, selectedMarker);\n\t\t\t\t\tthis.updateLinks(selectedNode);\n\t\t\t\t\tthis.panToNode(selectedNode);\n\t\t\t\t}, 500);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(\":(\");\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener(\"keydown\", this.keyDownHandler, false);\n\t}\n\n\t// This is a kinda hacky way to improve performance\n\t// Instead of rerending the entire map, rerender specific nodes\n\tshouldComponentUpdate(nextProps) {\n\t\tif (this.props.nodes !== nextProps.node) {\n\t\t\tthis.handleSelectedChange(nextProps);\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thandleKeyDown(event) {\n\t\tif (event.keyCode === 27) {\n\t\t\tconst { history } = this.context.router;\n\t\t\thistory.push(\"/\");\n\t\t}\n\t}\n\n\thandleSelectedChange(nextProps) {\n\t\t// If selected node is unchanged, do not rerender\n\t\tif (!this.props.match && !nextProps.match) return false;\n\n\t\t// If one was selected but none now selected, reset all nodes\n\t\tif (!nextProps.match) {\n\t\t\tthis.resetAllNodes();\n\t\t\treturn false;\n\t\t}\n\n\t\tconst nextSelectedNodeId = parseInt(nextProps.match.params.nodeId, 10);\n\t\tconst nextSelectedMarker = this.markerRefs[nextSelectedNodeId];\n\n\t\tif (!nextSelectedMarker) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { node: nextSelectedNode } = nextSelectedMarker.props;\n\n\t\tthis.updateNodes(nextSelectedNode, nextSelectedMarker);\n\t\tthis.updateLinks(nextSelectedNode);\n\t\tthis.panToNode(nextSelectedNode);\n\t}\n\n\trender() {\n\t\tconst { history } = this.context.router;\n\t\treturn (\n\t\t\t<MapComponent\n\t\t\t\tmapRef={this.map}\n\t\t\t\tdefaultZoom={13}\n\t\t\t\tdefaultCenter={{ lat: 40.7101809, lng: -73.9595798 }}\n\t\t\t\tdefaultOptions={options}\n\t\t\t\tonClick={() => history.push(\"/\")}\n\t\t\t\tgoogleMapURL=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBNClp7oJsw-eleEoR3-PQKV23tpeW-FpE\"\n\t\t\t\tloadingElement={<div className=\"h-100 bg-map-beige\" />}\n\t\t\t\tcontainerElement={<div className=\"h-100 bg-map-beige\" />}\n\t\t\t\tmapElement={<div className=\"h-100 bg-map-beige\" />}\n\t\t\t>\n\t\t\t\t{this.renderSectors()}\n\t\t\t\t{this.renderLinks()}\n\t\t\t\t{this.renderKiosks()}\n\t\t\t\t{this.renderNodes()}\n\t\t\t\t<NodeDetail match={this.props.match} />\n\t\t\t</MapComponent>\n\t\t);\n\t}\n\n\trenderNodes() {\n\t\tconst { nodes } = this.props;\n\t\treturn nodes.map(node => (\n\t\t\t<NodeMarker\n\t\t\t\tkey={node.id}\n\t\t\t\tref={ref => {\n\t\t\t\t\tthis.handleMarkerRef(ref);\n\t\t\t\t}}\n\t\t\t\tnode={node}\n\t\t\t/>\n\t\t));\n\t}\n\n\trenderKiosks() {\n\t\tconst { kiosks } = this.props;\n\t\treturn kiosks.map(kiosk => (\n\t\t\t<KioskMarker key={kiosk.id} kiosk={kiosk} />\n\t\t));\n\t}\n\n\trenderLinks() {\n\t\tconst { links } = this.props;\n\t\treturn links.map((link, index) => (\n\t\t\t<LinkLine\n\t\t\t\tkey={this.linkId(link)}\n\t\t\t\tref={ref => {\n\t\t\t\t\tthis.handleLineRef(ref);\n\t\t\t\t}}\n\t\t\t\tlink={link}\n\t\t\t/>\n\t\t));\n\t}\n\n\trenderSectors() {\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<Sector\n\t\t\t\t\tlat={40.711137}\n\t\t\t\t\tlng={-74.001122}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={55}\n\t\t\t\t\twidth={90}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tlat={40.713991}\n\t\t\t\t\tlng={-73.929049}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={180}\n\t\t\t\t\twidth={220}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tlat={40.685823}\n\t\t\t\t\tlng={-73.917272}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={180}\n\t\t\t\t\twidth={360}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tpotential={true}\n\t\t\t\t\tlat={40.657867}\n\t\t\t\t\tlng={-74.004904}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={40}\n\t\t\t\t\twidth={120}\n\t\t\t\t/>\n\t\t\t\t<Sector\n\t\t\t\t\tpotential={true}\n\t\t\t\t\tlat={40.657867}\n\t\t\t\t\tlng={-74.004904}\n\t\t\t\t\tr={2}\n\t\t\t\t\tazimuth={160}\n\t\t\t\t\twidth={120}\n\t\t\t\t/>\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\tresetAllNodes() {\n\t\tReactDOM.unstable_batchedUpdates(() => {\n\t\t\tObject.values(this.markerRefs).forEach(marker =>\n\t\t\t\tmarker.setVisibility(\"default\")\n\t\t\t);\n\n\t\t\tObject.values(this.lineRefs).forEach(line =>\n\t\t\t\tline.setVisibility(\"default\")\n\t\t\t);\n\t\t});\n\t}\n\n\tupdateNodes(node, marker) {\n\t\tReactDOM.unstable_batchedUpdates(() => {\n\t\t\t// Dim all nodes of same type\n\n\t\t\t// TODO: optimize performance by only resetting selected nodes\n\t\t\t// (selected node and all nodes of opposite type)\n\t\t\tObject.values(this.markerRefs).forEach(marker => {\n\t\t\t\tif (node.status === \"Installed\") {\n\t\t\t\t\tif (node.id !== marker.props.node.id) {\n\t\t\t\t\t\tmarker.setVisibility(\"dim\");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (marker.props.node.status === \"Installed\") {\n\t\t\t\t\t\tmarker.setVisibility(\"default\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmarker.setVisibility(\"dim\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Highlight selected node\n\t\t\tmarker.setVisibility(\"highlight\");\n\n\t\t\t// Highlight directly connected nodes\n\t\t\tnode.connectedNodes &&\n\t\t\t\tnode.connectedNodes.forEach(connectedNodeId => {\n\t\t\t\t\tconst connectedMarker = this.markerRefs[connectedNodeId];\n\t\t\t\t\tif (connectedMarker) {\n\t\t\t\t\t\tconnectedMarker.setVisibility(\"highlight\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\t}\n\n\tupdateLinks(node) {\n\t\t// Dim all links\n\t\tObject.values(this.lineRefs).forEach(line => line.setVisibility(\"dim\"));\n\n\t\t// Highlight direct links\n\t\tif (node.links) {\n\t\t\tnode.links.forEach(link => {\n\t\t\t\tconst line = this.lineRefs[this.linkId(link)];\n\t\t\t\tif (line) {\n\t\t\t\t\tline.setVisibility(\"highlight\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpanToNode(node) {\n\t\t// TODO: only if out of viewport\n\t\tconst [lng, lat] = node.coordinates;\n\t\tthis.map.current.panTo({ lat, lng });\n\t}\n\n\thandleMarkerRef(ref) {\n\t\tif (ref) {\n\t\t\tthis.markerRefs[ref.props.node.id] = ref;\n\t\t}\n\t}\n\n\thandleLineRef(ref) {\n\t\tif (ref) {\n\t\t\tthis.lineRefs[this.linkId(ref.props.link)] = ref;\n\t\t}\n\t}\n\n\tlinkId(link) {\n\t\treturn `${link.from}-${link.to} ${link.coordinates} ${link.status}`;\n\t}\n}\n\nexport default withRouter(MapView);\n","export const mapStyles = [\n\t{\n\t\telementType: \"labels.icon\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tfeatureType: \"road\",\n\t\telementType: \"labels.icon\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tfeatureType: \"road.highway\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\tfeatureType: \"transit\",\n\t\tstylers: [\n\t\t\t{\n\t\t\t\tvisibility: \"off\"\n\t\t\t}\n\t\t]\n\t}\n];\n","import { connect } from \"react-redux\";\nimport PureMapView from \"./component\";\n\nimport { fetchNodes, fetchLinks, fetchKiosks } from \"../../actions\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.filteredNodes,\n\tlinks: state.filteredLinks,\n\tkiosks: state.kiosks,\n\ttickets: state.tickets\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n\tfetchNodes: () => fetchNodes(dispatch),\n\tfetchLinks: () => fetchLinks(dispatch),\n\tfetchKiosks: () => fetchKiosks(dispatch)\n});\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(PureMapView);\n","export function fetchNodes(dispatch) {\n\tfetch(\"https://node-db.netlify.com/nodes.json\")\n\t\t.then(res => res.json())\n\t\t.then(json => {\n\t\t\tdispatch({ type: \"FETCH_NODES_SUCCESS\", nodes: json });\n\t\t})\n\t\t.catch(err => console.log(err));\n}\n\nexport function fetchLinks(dispatch) {\n\tfetch(\"https://node-db.netlify.com/links.json\")\n\t\t.then(res => res.json())\n\t\t.then(json => {\n\t\t\tdispatch({ type: \"FETCH_LINKS_SUCCESS\", links: json });\n\t\t})\n\t\t.catch(err => console.log(err));\n}\n\nexport function fetchKiosks(dispatch) {\n\tfetch(\"https://node-db.netlify.com/kiosks.json\")\n\t\t.then(res => res.json())\n\t\t.then(json => {\n\t\t\tdispatch({ type: \"FETCH_KIOSKS_SUCCESS\", kiosks: json });\n\t\t})\n\t\t.catch(err => console.log(err));\n}\n\nexport function toggleFilter(label, dispatch) {\n\tdispatch({ type: \"TOGGLE_FILTER\", label });\n}\n","import React, { PureComponent } from \"react\";\n\nimport { icons } from \"../NodeName\";\nimport { nodeColors } from \"../../utils\";\n\n// This should be defined elsewhere\nconst labels = [\"active\", \"potential\", \"supernode\", \"hub\", \"linkNYC\"];\n\nexport default class Filters extends PureComponent {\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"bg-white shadow-2\">\n\t\t\t\t<div role=\"group\" className=\"dib pa2\">\n\t\t\t\t\t<div>{labels.map(label => this.renderFilter(label))}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderFilter(label) {\n\t\tconst { filters, statusCounts, toggleFilter } = this.props;\n\t\tconst opacity =\n\t\t\tfilters[label] || filters[label] === undefined\n\t\t\t\t? \"o-100\"\n\t\t\t\t: \"o-50 strike\";\n\t\treturn (\n\t\t\t<div key={label} className={`pointer ${opacity}`}>\n\t\t\t\t<input\n\t\t\t\t\tclassName=\"ma0 mr1 dn\"\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tid={label}\n\t\t\t\t\tname=\"feature\"\n\t\t\t\t\tvalue={label}\n\t\t\t\t\tdefaultChecked={true}\n\t\t\t\t/>\n\t\t\t\t<label\n\t\t\t\t\thtmlFor={label}\n\t\t\t\t\tstyle={{ color: nodeColors[label] }}\n\t\t\t\t\tclassName=\"ttc pointer flex items-center nowrap\"\n\t\t\t\t\tonClick={() => toggleFilter(label)}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tmarginLeft: \"-0.5rem\",\n\t\t\t\t\t\t\tmarginRight: \"-0.25rem\",\n\t\t\t\t\t\t\tmarginTop: \"-0.125rem\",\n\t\t\t\t\t\t\tmarginBottom: \"-0.125rem\"\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName=\"h2 w2 flex items-center justify-center\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{icons[label]}\n\t\t\t\t\t</div>\n\t\t\t\t\t<span className=\"ml1\">\n\t\t\t\t\t\t{label.replace(\"-\", \" \")} ({statusCounts[label] || 0})\n\t\t\t\t\t</span>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import { connect } from \"react-redux\";\nimport PureFilters from \"./component\";\n\nimport { toggleFilter } from \"../../actions\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tfilters: state.filters,\n\tstatusCounts: state.statusCounts\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n\ttoggleFilter: label => toggleFilter(label, dispatch)\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureFilters);\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Link } from \"react-router-dom\";\nimport DocumentTitle from \"react-document-title\";\n\nexport default class Gallery extends PureComponent {\n\tstatic contextTypes = {\n\t\trouter: PropTypes.object\n\t};\n\n\tcomponentDidMount() {\n\t\tthis.keyDownHandler = this.handleKeyDown.bind(this);\n\t\twindow.addEventListener(\"keydown\", this.keyDownHandler, false);\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener(\"keydown\", this.keyDownHandler, false);\n\t}\n\n\thandleKeyDown(event) {\n\t\tif (event.keyCode === 27) {\n\t\t\tconst { match } = this.props;\n\t\t\tconst { nodeId } = match.params;\n\t\t\tconst { history } = this.context.router;\n\t\t\thistory.push(`/nodes/${nodeId}`);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { match, nodes } = this.props;\n\t\tconst { nodeId, panoId } = match.params;\n\t\tconst matchingNodes = nodes.filter(\n\t\t\tnode => node.id === parseInt(nodeId, 10)\n\t\t);\n\t\tif (!matchingNodes || !matchingNodes.length) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { panoramas } = matchingNodes[0];\n\t\tif (!panoramas || !panoramas.length) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst src = panoramas[panoId - 1];\n\n\t\treturn (\n\t\t\t<DocumentTitle\n\t\t\t\ttitle={`Panorama ${panoId} - Node ${nodeId} - NYC Mesh`}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tonKeyDown={e => this.onKeyPressed(e)}\n\t\t\t\t\tclassName=\"fixed absolute--fill bg-black flex items-center justify-center z-max\"\n\t\t\t\t>\n\t\t\t\t\t<Link to=\"..\" className=\"absolute top-0 left-0 ma3 white\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tclassName=\"db ma0\"\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstrokeWidth=\"3\"\n\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n\t\t\t\t\t\t\t<line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</Link>\n\n\t\t\t\t\t<img\n\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\twindow\n\t\t\t\t\t\t\t\t.open(\n\t\t\t\t\t\t\t\t\t`https://node-db.netlify.com/panoramas/${src}`,\n\t\t\t\t\t\t\t\t\t\"_blank\"\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.focus()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclassName=\"db center mh-100 mw-100 zoom-in\"\n\t\t\t\t\t\tsrc={`https://node-db.netlify.com/panoramas/${src}`}\n\t\t\t\t\t\talt=\"Panorama\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</DocumentTitle>\n\t\t);\n\t}\n\n\tonKeyPressed(e) {}\n}\n","import { connect } from \"react-redux\";\nimport PureGallery from \"./component\";\n\nconst mapStateToProps = (state, ownProps) => ({\n\tnodes: state.nodes\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PureGallery);\n","import { nodeStatus } from \"../utils\";\n\nconst initialFilters = {};\n\nconst initialState = {\n\tnodes: [],\n\tlinks: [],\n\tkiosks: [],\n\tfilteredNodes: [],\n\tfilteredLinks: [],\n\tfilters: initialFilters,\n\tstatusCounts: {}\n};\n\nconst reducer = (state = initialState, action) => {\n\tswitch (action.type) {\n\t\tcase \"TOGGLE_FILTER\":\n\t\t\tconst newFilters = {\n\t\t\t\t...state.filters,\n\t\t\t\t[action.label]:\n\t\t\t\t\tstate.filters[action.label] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[action.label]\n\t\t\t};\n\t\t\tif (action.label === \"potential\") {\n\t\t\t\tnewFilters[\"dead\"] =\n\t\t\t\t\tstate.filters[\"dead\"] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[\"dead\"];\n\t\t\t\tnewFilters[\"potential-hub\"] =\n\t\t\t\t\tstate.filters[\"potential-hub\"] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[\"potential-hub\"];\n\t\t\t\tnewFilters[\"potential-supernode\"] =\n\t\t\t\t\tstate.filters[\"potential-supernode\"] === undefined\n\t\t\t\t\t\t? false\n\t\t\t\t\t\t: !state.filters[\"potential-supernode\"];\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tfilters: newFilters,\n\t\t\t\tfilteredNodes: filterNodes(state.nodes, newFilters),\n\t\t\t\tfilteredLinks: filterLinks(state.links, newFilters)\n\t\t\t\t// kiosks: newFilters.linkNYC === false ? [] : state.kiosks\n\t\t\t};\n\t\tcase \"FETCH_NODES_SUCCESS\":\n\t\t\tconst { nodes: newNodes } = addGraphData(action.nodes, state.links);\n\t\t\tconst newStatusCounts = getCounts(action.nodes);\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tnodes: newNodes,\n\t\t\t\tfilteredNodes: filterNodes(newNodes, state.filters),\n\t\t\t\tstatusCounts: newStatusCounts\n\t\t\t};\n\t\tcase \"FETCH_LINKS_SUCCESS\":\n\t\t\tconst { links: newLinks } = addGraphData(state.nodes, action.links);\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tlinks: newLinks,\n\t\t\t\tfilteredLinks: filterLinks(newLinks, state.filters)\n\t\t\t};\n\t\tcase \"FETCH_KIOSKS_SUCCESS\":\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tkiosks: action.kiosks,\n\t\t\t\tstatusCounts: {\n\t\t\t\t\t...state.statusCounts,\n\t\t\t\t\tlinkNYC: action.kiosks.length\n\t\t\t\t}\n\t\t\t};\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n\nfunction filterNodes(nodes, filters) {\n\treturn nodes.filter(\n\t\tnode =>\n\t\t\tfilters[nodeStatus(node)] === undefined || filters[nodeStatus(node)]\n\t);\n}\n\nfunction filterLinks(links, filters) {\n\treturn links.filter(link => {\n\t\tif (!link.fromNode || !link.toNode) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\tfilters[nodeStatus(link.fromNode)] !== undefined &&\n\t\t\tfilters[nodeStatus(link.fromNode)] === false\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tfilters[nodeStatus(link.toNode)] !== undefined &&\n\t\t\tfilters[nodeStatus(link.toNode)] === false\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n}\n\nfunction addGraphData(nodes, links) {\n\t// Calculate connected nodes for each active node\n\tconst connectedNodes = {};\n\tnodes.filter(node => node.status === \"Installed\").forEach(node => {\n\t\tconst connectedNodes = [node.id];\n\n\t\tlinks.forEach(link => {\n\t\t\tif (link.status !== \"active\") return;\n\t\t\tif (link.from === parseInt(node.id, 10)) {\n\t\t\t\tconnectedNodes.push(link.to);\n\t\t\t}\n\n\t\t\tif (link.to === parseInt(node.id, 10)) {\n\t\t\t\tconnectedNodes.push(link.from);\n\t\t\t}\n\t\t});\n\n\t\tnode.connectedNodes = connectedNodes;\n\t});\n\n\tconst nodeMap = {};\n\n\tnodes.forEach(node => {\n\t\t// Add links to node\n\t\tnode.links = links.filter(\n\t\t\tlink =>\n\t\t\t\tlink.status === \"active\" &&\n\t\t\t\t(link.from === parseInt(node.id, 10) ||\n\t\t\t\t\tlink.to === parseInt(node.id, 10))\n\t\t);\n\n\t\tnodeMap[node.id] = node;\n\t});\n\n\tlinks.forEach(link => {\n\t\tlink.fromNode = nodeMap[link.from];\n\t\tlink.toNode = nodeMap[link.to];\n\t});\n\n\treturn { nodes, links };\n}\n\nfunction getCounts(nodes) {\n\tconst counts = {};\n\tnodes.forEach(node => {\n\t\tconst status = nodeStatus(node);\n\t\tcounts[status] = (counts[status] || 0) + 1;\n\n\t\tif (status.indexOf(\"potential-\") > -1 || status === \"dead\") {\n\t\t\tcounts[\"potential\"] = (counts[\"potential\"] || 0) + 1;\n\t\t}\n\n\t\tif (status === \"supernode\" || status === \"hub\") {\n\t\t\tcounts[\"active\"] = (counts[\"active\"] || 0) + 1;\n\t\t}\n\t});\n\treturn counts;\n}\n\nexport default reducer;\n","import { createStore } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport DocumentTitle from \"react-document-title\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\n\nimport React, { Component } from \"react\";\nimport SearchBar from \"./components/SearchBar\";\nimport MapView from \"./components/MapView\";\nimport Filters from \"./components/Filters\";\nimport Gallery from \"./components/Gallery\";\n\nimport rootReducer from \"./reducers\";\n\nconst store = createStore(rootReducer);\n\nclass App extends Component {\n\trender() {\n\t\treturn (\n\t\t\t<DocumentTitle title=\"Map - NYC Mesh\">\n\t\t\t\t<Provider store={store}>\n\t\t\t\t\t<Router basename={\"/map\"}>\n\t\t\t\t\t\t<div className=\"h-100 sans-serif\">\n\t\t\t\t\t\t\t<div className=\"h-100 w-100 relative\">\n\t\t\t\t\t\t\t\t<div className=\"absolute pa2 z-999 search-bar\">\n\t\t\t\t\t\t\t\t\t<SearchBar />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\t\t\tpath=\"/nodes/:nodeId\"\n\t\t\t\t\t\t\t\t\tchildren={({ match }) => (\n\t\t\t\t\t\t\t\t\t\t<MapView match={match} />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<div className=\"absolute bottom-0 left-0 ma2\">\n\t\t\t\t\t\t\t\t\t<Filters />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\t\tpath=\"/nodes/:nodeId/panoramas/:panoId\"\n\t\t\t\t\t\t\t\tcomponent={Gallery}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Router>\n\t\t\t\t</Provider>\n\t\t\t</DocumentTitle>\n\t\t);\n\t}\n\n\thandleNodeClick(node) {}\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"map-root\"));\n"],"sourceRoot":""}